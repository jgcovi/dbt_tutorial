2021-10-18 01:33:46.717462 (MainThread): Running with dbt=0.21.0
2021-10-18 01:33:47.040521 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 01:33:47.041491 (MainThread): Tracking: tracking
2021-10-18 01:33:47.042710 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2f9ae240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2f9ae4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2f9ae4a8>]}
2021-10-18 01:33:47.064866 (MainThread): Partial parsing not enabled
2021-10-18 01:33:47.076063 (MainThread): Parsing macros/adapters.sql
2021-10-18 01:33:47.100174 (MainThread): Parsing macros/etc.sql
2021-10-18 01:33:47.102299 (MainThread): Parsing macros/catalog.sql
2021-10-18 01:33:47.107831 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 01:33:47.118030 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 01:33:47.121191 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 01:33:47.123189 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 01:33:47.126188 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 01:33:47.143004 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 01:33:47.146376 (MainThread): Parsing macros/core.sql
2021-10-18 01:33:47.150236 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 01:33:47.161099 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 01:33:47.168095 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 01:33:47.191028 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 01:33:47.195514 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 01:33:47.202581 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 01:33:47.216170 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 01:33:47.218010 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 01:33:47.248055 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 01:33:47.265448 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 01:33:47.284555 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 01:33:47.286578 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 01:33:47.296826 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 01:33:47.304682 (MainThread): Parsing macros/etc/query.sql
2021-10-18 01:33:47.305942 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 01:33:47.308758 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 01:33:47.317541 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 01:33:47.319349 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 01:33:47.321387 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 01:33:47.323068 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 01:33:47.324654 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 01:33:47.376884 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 01:33:47.378532 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 01:33:47.379954 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 01:33:47.382379 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 01:33:47.579942 (MainThread): Acquiring new bigquery connection "model.dbt_tutorial.my_first_dbt_model".
2021-10-18 01:33:47.595159 (MainThread): Acquiring new bigquery connection "model.dbt_tutorial.my_second_dbt_model".
2021-10-18 01:33:47.624984 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:33:47.627332 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:33:47.629372 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:33:47.670769 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:33:47.680680 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example

2021-10-18 01:33:47.686229 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ca9dc6-df8b-4eb1-8e80-9fe0a1c067af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2f9aed30>]}
2021-10-18 01:33:47.690693 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ca9dc6-df8b-4eb1-8e80-9fe0a1c067af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2f9d7c50>]}
2021-10-18 01:33:47.691047 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 01:33:47.692093 (MainThread): 
2021-10-18 01:33:47.692571 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:33:47.693995 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttest2021".
2021-10-18 01:33:47.694361 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 01:33:48.197423 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttest2021_dbt_jessie".
2021-10-18 01:33:48.198161 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 01:33:48.209736 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 01:33:48.708914 (MainThread): 21:33:48 | Concurrency: 1 threads (target='dev')
2021-10-18 01:33:48.709555 (MainThread): 21:33:48 | 
2021-10-18 01:33:48.713577 (Thread-1): Began running node model.dbt_tutorial.my_first_dbt_model
2021-10-18 01:33:48.714478 (Thread-1): 21:33:48 | 1 of 2 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 01:33:48.715492 (Thread-1): Acquiring new bigquery connection "model.dbt_tutorial.my_first_dbt_model".
2021-10-18 01:33:48.716021 (Thread-1): Compiling model.dbt_tutorial.my_first_dbt_model
2021-10-18 01:33:48.722135 (Thread-1): Writing injected SQL for node "model.dbt_tutorial.my_first_dbt_model"
2021-10-18 01:33:48.723184 (Thread-1): finished collecting timing info
2021-10-18 01:33:48.725673 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54272), raddr=('142.250.64.106', 443)>
2021-10-18 01:33:48.726461 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53054), raddr=('142.250.80.10', 443)>
2021-10-18 01:33:48.727217 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54276), raddr=('142.250.64.106', 443)>
2021-10-18 01:33:48.728079 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53058), raddr=('142.250.80.10', 443)>
2021-10-18 01:33:48.798996 (Thread-1): Writing runtime SQL for node "model.dbt_tutorial.my_first_dbt_model"
2021-10-18 01:33:48.799529 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 01:33:48.804371 (Thread-1): On model.dbt_tutorial.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_tutorial.my_first_dbt_model"} */


  create or replace table `dbttest2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 01:33:49.424636 (Thread-1): finished collecting timing info
2021-10-18 01:33:49.425773 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
  compiled SQL at target/run/dbt_tutorial/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).

(job ID: c3aac3ce-14bf-47d5-a6ab-1a2650ce9f4e)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.dbt_tutorial.my_first_dbt_model"} */
   2:
   3:
   4:  create or replace table `dbttest2021`.`dbt_jessie`.`my_first_dbt_model`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    /*
  10:    Welcome to your first dbt model!
  11:    Did you know that you can also configure models directly within SQL files?
  12:    This will override configurations stated in dbt_project.yml
  13:
  14:    Try changing "table" to "view" below
  15:*/
  16:
  17:
  18:
  19:with source_data as (
  20:
  21:    select 1 as id
  22:    union all
  23:    select null as id
  24:
  25:)
  26:
  27:select *
  28:from source_data
  29:
  30:/*
  31:    Uncomment the line below to remove records with null `id` values
  32:*/
  33:
  34:-- where id is not null
  35:  );
  36:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
  compiled SQL at target/run/dbt_tutorial/models/example/my_first_dbt_model.sql
2021-10-18 01:33:49.433100 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ca9dc6-df8b-4eb1-8e80-9fe0a1c067af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2f834978>]}
2021-10-18 01:33:49.434057 (Thread-1): 21:33:49 | 1 of 2 ERROR creating table model dbt_jessie.my_first_dbt_model...... [ERROR in 0.72s]
2021-10-18 01:33:49.434565 (Thread-1): Finished running node model.dbt_tutorial.my_first_dbt_model
2021-10-18 01:33:49.435938 (Thread-1): Began running node model.dbt_tutorial.my_second_dbt_model
2021-10-18 01:33:49.436539 (Thread-1): 21:33:49 | 2 of 2 SKIP relation dbt_jessie.my_second_dbt_model.................. [SKIP]
2021-10-18 01:33:49.437008 (Thread-1): Finished running node model.dbt_tutorial.my_second_dbt_model
2021-10-18 01:33:49.515780 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:33:49.517017 (MainThread): 21:33:49 | 
2021-10-18 01:33:49.517792 (MainThread): 21:33:49 | Finished running 1 table model, 1 view model in 1.82s.
2021-10-18 01:33:49.518520 (MainThread): Connection 'master' was properly closed.
2021-10-18 01:33:49.519163 (MainThread): Connection 'model.dbt_tutorial.my_first_dbt_model' was properly closed.
2021-10-18 01:33:49.530443 (MainThread): 
2021-10-18 01:33:49.531278 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 01:33:49.532088 (MainThread): 
2021-10-18 01:33:49.532950 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-10-18 01:33:49.533745 (MainThread):   Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
2021-10-18 01:33:49.534533 (MainThread):   compiled SQL at target/run/dbt_tutorial/models/example/my_first_dbt_model.sql
2021-10-18 01:33:49.535303 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-18 01:33:49.536139 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2f88d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2f9d7b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc32df6080>]}
2021-10-18 01:33:49.537037 (MainThread): Flushing usage events
2021-10-18 01:36:01.168433 (MainThread): Running with dbt=0.21.0
2021-10-18 01:36:01.463330 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 01:36:01.464161 (MainThread): Tracking: tracking
2021-10-18 01:36:01.465181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0223366b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021e058390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021e058048>]}
2021-10-18 01:36:01.476832 (MainThread): Partial parsing not enabled
2021-10-18 01:36:01.484300 (MainThread): Parsing macros/adapters.sql
2021-10-18 01:36:01.507676 (MainThread): Parsing macros/etc.sql
2021-10-18 01:36:01.509775 (MainThread): Parsing macros/catalog.sql
2021-10-18 01:36:01.515308 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 01:36:01.525479 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 01:36:01.528354 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 01:36:01.530267 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 01:36:01.533007 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 01:36:01.549263 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 01:36:01.552517 (MainThread): Parsing macros/core.sql
2021-10-18 01:36:01.556321 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 01:36:01.566695 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 01:36:01.574098 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 01:36:01.596602 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 01:36:01.601203 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 01:36:01.608367 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 01:36:01.622179 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 01:36:01.624104 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 01:36:01.653702 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 01:36:01.673999 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 01:36:01.692936 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 01:36:01.694915 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 01:36:01.705084 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 01:36:01.712351 (MainThread): Parsing macros/etc/query.sql
2021-10-18 01:36:01.713489 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 01:36:01.716049 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 01:36:01.724397 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 01:36:01.726300 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 01:36:01.728394 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 01:36:01.730084 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 01:36:01.731645 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 01:36:01.781749 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 01:36:01.783299 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 01:36:01.784775 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 01:36:01.787344 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 01:36:01.987576 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 01:36:02.001001 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 01:36:02.030300 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:36:02.032507 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:36:02.034744 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:36:02.077538 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:36:02.091714 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a08b27d-d0d7-42c6-9b9e-2e7e3dc9c624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021e2ac198>]}
2021-10-18 01:36:02.096444 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a08b27d-d0d7-42c6-9b9e-2e7e3dc9c624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021e07f588>]}
2021-10-18 01:36:02.096813 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 01:36:02.097850 (MainThread): 
2021-10-18 01:36:02.098254 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:36:02.099326 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttest2021".
2021-10-18 01:36:02.099629 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 01:36:02.828129 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttest2021_dbt_jessie".
2021-10-18 01:36:02.828777 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 01:36:02.840510 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 01:36:03.368216 (MainThread): 21:36:03 | Concurrency: 1 threads (target='dev')
2021-10-18 01:36:03.368981 (MainThread): 21:36:03 | 
2021-10-18 01:36:03.372617 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 01:36:03.373510 (Thread-1): 21:36:03 | 1 of 2 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 01:36:03.374489 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 01:36:03.374973 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 01:36:03.381297 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 01:36:03.382663 (Thread-1): finished collecting timing info
2021-10-18 01:36:03.384962 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54298), raddr=('142.250.64.106', 443)>
2021-10-18 01:36:03.385854 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53080), raddr=('142.250.80.10', 443)>
2021-10-18 01:36:03.386701 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54302), raddr=('142.250.64.106', 443)>
2021-10-18 01:36:03.387252 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53084), raddr=('142.250.80.10', 443)>
2021-10-18 01:36:03.456380 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 01:36:03.456892 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 01:36:03.461849 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttest2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 01:36:04.390517 (Thread-1): finished collecting timing info
2021-10-18 01:36:04.391685 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
  compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).

(job ID: a1c1edad-9617-4f79-adad-bf1402a9d2cd)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
   2:
   3:
   4:  create or replace table `dbttest2021`.`dbt_jessie`.`my_first_dbt_model`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    /*
  10:    Welcome to your first dbt model!
  11:    Did you know that you can also configure models directly within SQL files?
  12:    This will override configurations stated in dbt_project.yml
  13:
  14:    Try changing "table" to "view" below
  15:*/
  16:
  17:
  18:
  19:with source_data as (
  20:
  21:    select 1 as id
  22:    union all
  23:    select null as id
  24:
  25:)
  26:
  27:select *
  28:from source_data
  29:
  30:/*
  31:    Uncomment the line below to remove records with null `id` values
  32:*/
  33:
  34:-- where id is not null
  35:  );
  36:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
  compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
2021-10-18 01:36:04.396609 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a08b27d-d0d7-42c6-9b9e-2e7e3dc9c624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021df2a1d0>]}
2021-10-18 01:36:04.397644 (Thread-1): 21:36:04 | 1 of 2 ERROR creating table model dbt_jessie.my_first_dbt_model...... [ERROR in 1.02s]
2021-10-18 01:36:04.398198 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 01:36:04.399501 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 01:36:04.400065 (Thread-1): 21:36:04 | 2 of 2 SKIP relation dbt_jessie.my_second_dbt_model.................. [SKIP]
2021-10-18 01:36:04.400517 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 01:36:04.475667 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:36:04.476643 (MainThread): 21:36:04 | 
2021-10-18 01:36:04.477125 (MainThread): 21:36:04 | Finished running 1 table model, 1 view model in 2.38s.
2021-10-18 01:36:04.477536 (MainThread): Connection 'master' was properly closed.
2021-10-18 01:36:04.477875 (MainThread): Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
2021-10-18 01:36:04.487558 (MainThread): 
2021-10-18 01:36:04.488106 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 01:36:04.488560 (MainThread): 
2021-10-18 01:36:04.489050 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-10-18 01:36:04.489440 (MainThread):   Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
2021-10-18 01:36:04.489791 (MainThread):   compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
2021-10-18 01:36:04.490236 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-18 01:36:04.491095 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021dfe38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0223366b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021e058f98>]}
2021-10-18 01:36:04.492049 (MainThread): Flushing usage events
2021-10-18 01:37:29.085908 (MainThread): Running with dbt=0.21.0
2021-10-18 01:37:29.401335 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 01:37:29.402218 (MainThread): Tracking: tracking
2021-10-18 01:37:29.403603 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12352a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12352a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12352a438>]}
2021-10-18 01:37:29.415732 (MainThread): Partial parsing not enabled
2021-10-18 01:37:29.424377 (MainThread): Parsing macros/adapters.sql
2021-10-18 01:37:29.449384 (MainThread): Parsing macros/etc.sql
2021-10-18 01:37:29.451869 (MainThread): Parsing macros/catalog.sql
2021-10-18 01:37:29.457872 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 01:37:29.468007 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 01:37:29.471254 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 01:37:29.473293 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 01:37:29.476185 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 01:37:29.493184 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 01:37:29.496255 (MainThread): Parsing macros/core.sql
2021-10-18 01:37:29.500438 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 01:37:29.511023 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 01:37:29.518447 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 01:37:29.542050 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 01:37:29.546373 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 01:37:29.554139 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 01:37:29.568750 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 01:37:29.571007 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 01:37:29.601746 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 01:37:29.620040 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 01:37:29.641173 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 01:37:29.643284 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 01:37:29.654020 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 01:37:29.661914 (MainThread): Parsing macros/etc/query.sql
2021-10-18 01:37:29.663199 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 01:37:29.665986 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 01:37:29.675685 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 01:37:29.677647 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 01:37:29.679534 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 01:37:29.681084 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 01:37:29.682876 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 01:37:29.736992 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 01:37:29.739098 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 01:37:29.740716 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 01:37:29.743127 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 01:37:29.957466 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 01:37:29.971967 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 01:37:30.005886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:37:30.007948 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:37:30.010149 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:37:30.055629 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:37:30.070385 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db7ffe9d-d9d9-42ae-bb30-eb210635003f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12a8903c8>]}
2021-10-18 01:37:30.075205 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db7ffe9d-d9d9-42ae-bb30-eb210635003f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12354a898>]}
2021-10-18 01:37:30.075595 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 01:37:30.076604 (MainThread): 
2021-10-18 01:37:30.077066 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:37:30.078174 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttest2021".
2021-10-18 01:37:30.078519 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 01:37:30.714953 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttest2021_dbt_jessie".
2021-10-18 01:37:30.715294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 01:37:30.720697 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 01:37:31.226576 (MainThread): 21:37:31 | Concurrency: 1 threads (target='dev')
2021-10-18 01:37:31.226903 (MainThread): 21:37:31 | 
2021-10-18 01:37:31.228931 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 01:37:31.229354 (Thread-1): 21:37:31 | 1 of 2 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 01:37:31.229786 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 01:37:31.229984 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 01:37:31.232539 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 01:37:31.232928 (Thread-1): finished collecting timing info
2021-10-18 01:37:31.233854 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54354), raddr=('142.250.64.106', 443)>
2021-10-18 01:37:31.234116 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53136), raddr=('142.250.80.10', 443)>
2021-10-18 01:37:31.234385 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54358), raddr=('142.250.64.106', 443)>
2021-10-18 01:37:31.234599 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53140), raddr=('142.250.80.10', 443)>
2021-10-18 01:37:31.275452 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 01:37:31.275909 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 01:37:31.280822 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttest2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 01:37:31.942882 (Thread-1): finished collecting timing info
2021-10-18 01:37:31.943488 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
  compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).

(job ID: 4de13820-6fb2-4555-add5-2a6455afe244)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
   2:
   3:
   4:  create or replace table `dbttest2021`.`dbt_jessie`.`my_first_dbt_model`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    /*
  10:    Welcome to your first dbt model!
  11:    Did you know that you can also configure models directly within SQL files?
  12:    This will override configurations stated in dbt_project.yml
  13:
  14:    Try changing "table" to "view" below
  15:*/
  16:
  17:
  18:
  19:with source_data as (
  20:
  21:    select 1 as id
  22:    union all
  23:    select null as id
  24:
  25:)
  26:
  27:select *
  28:from source_data
  29:
  30:/*
  31:    Uncomment the line below to remove records with null `id` values
  32:*/
  33:
  34:-- where id is not null
  35:  );
  36:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
  compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
2021-10-18 01:37:31.945610 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7ffe9d-d9d9-42ae-bb30-eb210635003f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1233f9b70>]}
2021-10-18 01:37:31.946014 (Thread-1): 21:37:31 | 1 of 2 ERROR creating table model dbt_jessie.my_first_dbt_model...... [ERROR in 0.72s]
2021-10-18 01:37:31.946251 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 01:37:31.946897 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 01:37:31.947132 (Thread-1): 21:37:31 | 2 of 2 SKIP relation dbt_jessie.my_second_dbt_model.................. [SKIP]
2021-10-18 01:37:31.947355 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 01:37:32.029974 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:37:32.030466 (MainThread): 21:37:32 | 
2021-10-18 01:37:32.030692 (MainThread): 21:37:32 | Finished running 1 table model, 1 view model in 1.95s.
2021-10-18 01:37:32.030864 (MainThread): Connection 'master' was properly closed.
2021-10-18 01:37:32.031004 (MainThread): Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
2021-10-18 01:37:32.035859 (MainThread): 
2021-10-18 01:37:32.036119 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 01:37:32.036298 (MainThread): 
2021-10-18 01:37:32.036489 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-10-18 01:37:32.036643 (MainThread):   Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
2021-10-18 01:37:32.036787 (MainThread):   compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
2021-10-18 01:37:32.036965 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-18 01:37:32.037201 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1233d6588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1234243c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc128836a90>]}
2021-10-18 01:37:32.037478 (MainThread): Flushing usage events
2021-10-18 01:51:25.696130 (MainThread): Running with dbt=0.21.0
2021-10-18 01:51:26.033308 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 01:51:26.034383 (MainThread): Tracking: tracking
2021-10-18 01:51:26.035333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121b15eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1215e513c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1215e51390>]}
2021-10-18 01:51:26.046542 (MainThread): Partial parsing not enabled
2021-10-18 01:51:26.055951 (MainThread): Parsing macros/adapters.sql
2021-10-18 01:51:26.078950 (MainThread): Parsing macros/etc.sql
2021-10-18 01:51:26.080901 (MainThread): Parsing macros/catalog.sql
2021-10-18 01:51:26.086215 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 01:51:26.095600 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 01:51:26.098140 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 01:51:26.099810 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 01:51:26.102672 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 01:51:26.118643 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 01:51:26.121409 (MainThread): Parsing macros/core.sql
2021-10-18 01:51:26.125177 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 01:51:26.134441 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 01:51:26.141228 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 01:51:26.163085 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 01:51:26.166940 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 01:51:26.173718 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 01:51:26.186887 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 01:51:26.188558 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 01:51:26.217745 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 01:51:26.234376 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 01:51:26.252726 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 01:51:26.254581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 01:51:26.264390 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 01:51:26.271342 (MainThread): Parsing macros/etc/query.sql
2021-10-18 01:51:26.272350 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 01:51:26.274897 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 01:51:26.283414 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 01:51:26.285047 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 01:51:26.286853 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 01:51:26.288291 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 01:51:26.289828 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 01:51:26.340204 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 01:51:26.341752 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 01:51:26.343056 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 01:51:26.345252 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 01:51:26.539532 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 01:51:26.552620 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 01:51:26.581583 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:51:26.583656 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:51:26.585500 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:51:26.627668 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:51:26.641308 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '581ccd45-f9ed-4b73-b282-57589753f2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121bb90240>]}
2021-10-18 01:51:26.645720 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '581ccd45-f9ed-4b73-b282-57589753f2b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1215e75630>]}
2021-10-18 01:51:26.646054 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 01:51:26.647020 (MainThread): 
2021-10-18 01:51:26.647408 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:51:26.648392 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttest2021".
2021-10-18 01:51:26.648667 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 01:51:26.648848 (ThreadPoolExecutor-0_0): Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/home/jessie/.dbt/dbt_user_creds.json''
2021-10-18 01:51:26.649485 (MainThread): Connection 'master' was properly closed.
2021-10-18 01:51:26.649672 (MainThread): Connection 'list_dbttest2021' was properly closed.
2021-10-18 01:51:26.649837 (MainThread): ERROR: Database Error
  [Errno 2] No such file or directory: '/home/jessie/.dbt/dbt_user_creds.json'
2021-10-18 01:51:26.650129 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f121d1b83c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1215d2b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1215d2b940>]}
2021-10-18 01:51:26.650348 (MainThread): Flushing usage events
2021-10-18 01:52:42.839901 (MainThread): Running with dbt=0.21.0
2021-10-18 01:52:43.136088 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 01:52:43.136973 (MainThread): Tracking: tracking
2021-10-18 01:52:43.137885 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa7c6278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa7c64a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa7c6470>]}
2021-10-18 01:52:43.149135 (MainThread): Partial parsing not enabled
2021-10-18 01:52:43.156539 (MainThread): Parsing macros/adapters.sql
2021-10-18 01:52:43.179682 (MainThread): Parsing macros/etc.sql
2021-10-18 01:52:43.181759 (MainThread): Parsing macros/catalog.sql
2021-10-18 01:52:43.187606 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 01:52:43.197208 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 01:52:43.199821 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 01:52:43.201645 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 01:52:43.204306 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 01:52:43.220023 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 01:52:43.222737 (MainThread): Parsing macros/core.sql
2021-10-18 01:52:43.226343 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 01:52:43.235885 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 01:52:43.242632 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 01:52:43.264470 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 01:52:43.268529 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 01:52:43.275334 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 01:52:43.288536 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 01:52:43.290206 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 01:52:43.319370 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 01:52:43.337335 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 01:52:43.356311 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 01:52:43.358169 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 01:52:43.368053 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 01:52:43.375195 (MainThread): Parsing macros/etc/query.sql
2021-10-18 01:52:43.376211 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 01:52:43.378681 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 01:52:43.386888 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 01:52:43.388564 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 01:52:43.390324 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 01:52:43.391734 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 01:52:43.393183 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 01:52:43.442939 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 01:52:43.444406 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 01:52:43.445618 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 01:52:43.447816 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 01:52:43.644389 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 01:52:43.657344 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 01:52:43.686625 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:52:43.688562 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:52:43.690232 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:52:43.732207 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 01:52:43.746223 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98e889c8-d86d-4dc4-bcd8-aa648d5e339a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa7eb9e8>]}
2021-10-18 01:52:43.750467 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98e889c8-d86d-4dc4-bcd8-aa648d5e339a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa7ebf28>]}
2021-10-18 01:52:43.750782 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 01:52:43.751701 (MainThread): 
2021-10-18 01:52:43.752125 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:52:43.753183 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttest2021".
2021-10-18 01:52:43.753437 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 01:52:44.248074 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttest2021_dbt_jessie".
2021-10-18 01:52:44.248854 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 01:52:44.261208 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 01:52:44.759502 (MainThread): 21:52:44 | Concurrency: 1 threads (target='dev')
2021-10-18 01:52:44.760107 (MainThread): 21:52:44 | 
2021-10-18 01:52:44.773911 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 01:52:44.774883 (Thread-1): 21:52:44 | 1 of 2 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 01:52:44.775849 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 01:52:44.776355 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 01:52:44.782437 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 01:52:44.783295 (Thread-1): finished collecting timing info
2021-10-18 01:52:44.785206 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54564), raddr=('142.250.64.106', 443)>
2021-10-18 01:52:44.785805 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53346), raddr=('142.250.80.10', 443)>
2021-10-18 01:52:44.786342 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54568), raddr=('142.250.64.106', 443)>
2021-10-18 01:52:44.786815 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53350), raddr=('142.250.80.10', 443)>
2021-10-18 01:52:44.857526 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 01:52:44.857986 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 01:52:44.862716 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttest2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 01:52:45.577578 (Thread-1): finished collecting timing info
2021-10-18 01:52:45.578640 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
  compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).

(job ID: f5560ca4-5357-4497-a721-6534e0d94ea1)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
   2:
   3:
   4:  create or replace table `dbttest2021`.`dbt_jessie`.`my_first_dbt_model`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    /*
  10:    Welcome to your first dbt model!
  11:    Did you know that you can also configure models directly within SQL files?
  12:    This will override configurations stated in dbt_project.yml
  13:
  14:    Try changing "table" to "view" below
  15:*/
  16:
  17:
  18:
  19:with source_data as (
  20:
  21:    select 1 as id
  22:    union all
  23:    select null as id
  24:
  25:)
  26:
  27:select *
  28:from source_data
  29:
  30:/*
  31:    Uncomment the line below to remove records with null `id` values
  32:*/
  33:
  34:-- where id is not null
  35:  );
  36:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 171, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
  compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
2021-10-18 01:52:45.586050 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e889c8-d86d-4dc4-bcd8-aa648d5e339a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa714c50>]}
2021-10-18 01:52:45.587062 (Thread-1): 21:52:45 | 1 of 2 ERROR creating table model dbt_jessie.my_first_dbt_model...... [ERROR in 0.81s]
2021-10-18 01:52:45.587530 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 01:52:45.588728 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 01:52:45.589298 (Thread-1): 21:52:45 | 2 of 2 SKIP relation dbt_jessie.my_second_dbt_model.................. [SKIP]
2021-10-18 01:52:45.589725 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 01:52:45.676294 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 01:52:45.677317 (MainThread): 21:52:45 | 
2021-10-18 01:52:45.677800 (MainThread): 21:52:45 | Finished running 1 table model, 1 view model in 1.93s.
2021-10-18 01:52:45.678210 (MainThread): Connection 'master' was properly closed.
2021-10-18 01:52:45.678550 (MainThread): Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
2021-10-18 01:52:45.689197 (MainThread): 
2021-10-18 01:52:45.689894 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 01:52:45.690340 (MainThread): 
2021-10-18 01:52:45.690806 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-10-18 01:52:45.691199 (MainThread):   Access Denied: Dataset dbttest2021:dbt_jessie: Permission bigquery.tables.create denied on dataset dbttest2021:dbt_jessie (or it may not exist).
2021-10-18 01:52:45.691546 (MainThread):   compiled SQL at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
2021-10-18 01:52:45.691905 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-18 01:52:45.692448 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe201b2e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa6872b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1fa6c3710>]}
2021-10-18 01:52:45.693109 (MainThread): Flushing usage events
2021-10-18 02:06:19.745635 (MainThread): Running with dbt=0.21.0
2021-10-18 02:06:20.039825 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:06:20.040668 (MainThread): Tracking: tracking
2021-10-18 02:06:20.041691 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3279f278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3279f4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3279f470>]}
2021-10-18 02:06:20.053004 (MainThread): Partial parsing not enabled
2021-10-18 02:06:20.063174 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:06:20.088457 (MainThread): Parsing macros/etc.sql
2021-10-18 02:06:20.090911 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:06:20.097320 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:06:20.108376 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:06:20.111404 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:06:20.113462 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:06:20.116540 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:06:20.133236 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:06:20.136452 (MainThread): Parsing macros/core.sql
2021-10-18 02:06:20.141087 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:06:20.151148 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:06:20.159288 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:06:20.181675 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:06:20.185987 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:06:20.193396 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:06:20.207670 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:06:20.209734 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:06:20.239857 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:06:20.257433 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:06:20.276483 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:06:20.278715 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:06:20.289283 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:06:20.296565 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:06:20.297682 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:06:20.300305 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:06:20.309055 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:06:20.311050 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:06:20.313017 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:06:20.314599 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:06:20.316152 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:06:20.366779 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:06:20.368422 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:06:20.369685 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:06:20.372411 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:06:20.572147 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:06:20.585343 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:06:20.615479 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:06:20.617593 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:06:20.619422 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:06:20.662069 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:06:20.676428 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a128d6a5-e4f5-46d5-a3d0-322298d47aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd329f3d30>]}
2021-10-18 02:06:20.680892 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a128d6a5-e4f5-46d5-a3d0-322298d47aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd327c19e8>]}
2021-10-18 02:06:20.681247 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:06:20.682298 (MainThread): 
2021-10-18 02:06:20.682737 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:06:20.683796 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:06:20.684058 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:06:21.058441 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_dbttutorial2021_dbt_jessie".
2021-10-18 02:06:21.059208 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_dbttutorial2021_dbt_jessie".
2021-10-18 02:06:21.059595 (ThreadPoolExecutor-0_0): Creating schema "dbttutorial2021.dbt_jessie".
2021-10-18 02:06:21.059938 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-10-18 02:06:21.071620 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:06:21.930768 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:06:21.931553 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:06:21.943541 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:06:22.442323 (MainThread): 22:06:22 | Concurrency: 1 threads (target='dev')
2021-10-18 02:06:22.442929 (MainThread): 22:06:22 | 
2021-10-18 02:06:22.446978 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:06:22.447862 (Thread-1): 22:06:22 | 1 of 2 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:06:22.448896 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:06:22.449397 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:06:22.451991 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 53958), raddr=('142.250.176.202', 443)>
2021-10-18 02:06:22.452529 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53608), raddr=('142.250.80.10', 443)>
2021-10-18 02:06:22.453092 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 53962), raddr=('142.250.176.202', 443)>
2021-10-18 02:06:22.453546 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53612), raddr=('142.250.80.10', 443)>
2021-10-18 02:06:22.453992 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 53966), raddr=('142.250.176.202', 443)>
2021-10-18 02:06:22.454457 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53616), raddr=('142.250.80.10', 443)>
2021-10-18 02:06:22.460654 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:06:22.461891 (Thread-1): finished collecting timing info
2021-10-18 02:06:22.533182 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:06:22.533674 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:06:22.538761 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:06:25.657721 (Thread-1): finished collecting timing info
2021-10-18 02:06:25.659447 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a128d6a5-e4f5-46d5-a3d0-322298d47aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3264e8d0>]}
2021-10-18 02:06:25.660797 (Thread-1): 22:06:25 | 1 of 2 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 3.21s]
2021-10-18 02:06:25.661442 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:06:25.662754 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:06:25.663594 (Thread-1): 22:06:25 | 2 of 2 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:06:25.664827 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:06:25.665416 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:06:25.670764 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:06:25.671569 (Thread-1): finished collecting timing info
2021-10-18 02:06:25.712057 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:06:25.712708 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:06:25.719240 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1;


2021-10-18 02:06:26.847993 (Thread-1): finished collecting timing info
2021-10-18 02:06:26.849183 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a128d6a5-e4f5-46d5-a3d0-322298d47aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd30560208>]}
2021-10-18 02:06:26.850135 (Thread-1): 22:06:26 | 2 of 2 OK created view model dbt_jessie.my_second_dbt_model.......... [OK in 1.18s]
2021-10-18 02:06:26.850654 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:06:26.862226 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:06:26.863307 (MainThread): 22:06:26 | 
2021-10-18 02:06:26.863892 (MainThread): 22:06:26 | Finished running 1 table model, 1 view model in 6.18s.
2021-10-18 02:06:26.864313 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:06:26.864689 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:06:26.866975 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 53976), raddr=('142.250.176.202', 443)>
2021-10-18 02:06:26.867655 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53628), raddr=('142.250.80.10', 443)>
2021-10-18 02:06:26.876985 (MainThread): 
2021-10-18 02:06:26.877655 (MainThread): Completed successfully
2021-10-18 02:06:26.878115 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-18 02:06:26.878679 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd32724ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd30585400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd30585c88>]}
2021-10-18 02:06:26.879295 (MainThread): Flushing usage events
2021-10-18 02:12:06.637049 (MainThread): Running with dbt=0.21.0
2021-10-18 02:12:06.924875 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='clean', write_json=True)
2021-10-18 02:12:06.925325 (MainThread): Tracking: tracking
2021-10-18 02:12:06.926013 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7cb2358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7cb2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7cb2128>]}
2021-10-18 02:12:06.926392 (MainThread): Checking target/*
2021-10-18 02:12:06.927338 (MainThread):  Cleaned target/*
2021-10-18 02:12:06.927550 (MainThread): Checking dbt_modules/*
2021-10-18 02:12:06.927777 (MainThread):  Cleaned dbt_modules/*
2021-10-18 02:12:06.927924 (MainThread): Finished cleaning all paths.
2021-10-18 02:12:06.928123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7cb2358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7cb2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da7cb21d0>]}
2021-10-18 02:12:06.928352 (MainThread): Flushing usage events
2021-10-18 02:13:38.254626 (MainThread): Running with dbt=0.21.0
2021-10-18 02:13:38.544347 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:13:38.545216 (MainThread): Tracking: tracking
2021-10-18 02:13:38.546174 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26e1742b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26e1744a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26e174470>]}
2021-10-18 02:13:38.557637 (MainThread): Partial parsing not enabled
2021-10-18 02:13:38.564622 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:13:38.587795 (MainThread): Parsing macros/etc.sql
2021-10-18 02:13:38.590086 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:13:38.595409 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:13:38.605639 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:13:38.608495 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:13:38.610218 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:13:38.612854 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:13:38.628590 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:13:38.631494 (MainThread): Parsing macros/core.sql
2021-10-18 02:13:38.635341 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:13:38.645045 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:13:38.652323 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:13:38.674387 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:13:38.678519 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:13:38.685627 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:13:38.699659 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:13:38.701425 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:13:38.731015 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:13:38.748562 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:13:38.767717 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:13:38.769762 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:13:38.779870 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:13:38.787087 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:13:38.788422 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:13:38.791250 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:13:38.799866 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:13:38.801728 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:13:38.803639 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:13:38.805255 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:13:38.806898 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:13:38.857042 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:13:38.858612 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:13:38.859949 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:13:38.862197 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:13:39.056811 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:13:39.080597 (MainThread): 1699: statically parsed example/my_second_dbt_model.sql
2021-10-18 02:13:39.080998 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:13:39.084673 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'd37c2386-1724-4aa3-a0c3-a4f49e159ccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26e082be0>]}
2021-10-18 02:13:39.111646 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:13:39.113815 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:13:39.115679 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:13:39.157425 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:13:39.171610 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd37c2386-1724-4aa3-a0c3-a4f49e159ccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26e174ba8>]}
2021-10-18 02:13:39.176023 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd37c2386-1724-4aa3-a0c3-a4f49e159ccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2754dc400>]}
2021-10-18 02:13:39.176374 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:13:39.177428 (MainThread): 
2021-10-18 02:13:39.177873 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:13:39.178955 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:13:39.179278 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:13:39.708254 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:13:39.709005 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:13:39.721395 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:13:40.322287 (MainThread): 22:13:40 | Concurrency: 1 threads (target='dev')
2021-10-18 02:13:40.322964 (MainThread): 22:13:40 | 
2021-10-18 02:13:40.326757 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:13:40.327728 (Thread-1): 22:13:40 | 1 of 2 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:13:40.329131 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:13:40.329819 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:13:40.335997 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:13:40.337193 (Thread-1): finished collecting timing info
2021-10-18 02:13:40.340165 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54106), raddr=('142.250.176.202', 443)>
2021-10-18 02:13:40.341171 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53756), raddr=('142.250.80.10', 443)>
2021-10-18 02:13:40.342075 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54110), raddr=('142.250.176.202', 443)>
2021-10-18 02:13:40.342856 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53760), raddr=('142.250.80.10', 443)>
2021-10-18 02:13:40.387988 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:13:40.396343 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:13:40.981158 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:13:40.982323 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:13:43.301628 (Thread-1): finished collecting timing info
2021-10-18 02:13:43.302731 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37c2386-1724-4aa3-a0c3-a4f49e159ccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26d03df28>]}
2021-10-18 02:13:43.303694 (Thread-1): 22:13:43 | 1 of 2 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.97s]
2021-10-18 02:13:43.304198 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:13:43.305437 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:13:43.306116 (Thread-1): 22:13:43 | 2 of 2 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:13:43.306903 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:13:43.307333 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:13:43.312389 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:13:43.313143 (Thread-1): finished collecting timing info
2021-10-18 02:13:43.351976 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:13:43.352820 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:13:43.361300 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1;


2021-10-18 02:13:44.317094 (Thread-1): finished collecting timing info
2021-10-18 02:13:44.318259 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37c2386-1724-4aa3-a0c3-a4f49e159ccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26e1128d0>]}
2021-10-18 02:13:44.319238 (Thread-1): 22:13:44 | 2 of 2 OK created view model dbt_jessie.my_second_dbt_model.......... [OK in 1.01s]
2021-10-18 02:13:44.319928 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:13:44.343728 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:13:44.345050 (MainThread): 22:13:44 | 
2021-10-18 02:13:44.345840 (MainThread): 22:13:44 | Finished running 1 table model, 1 view model in 5.17s.
2021-10-18 02:13:44.346560 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:13:44.347201 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:13:44.350051 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54118), raddr=('142.250.176.202', 443)>
2021-10-18 02:13:44.350862 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 53768), raddr=('142.250.80.10', 443)>
2021-10-18 02:13:44.360259 (MainThread): 
2021-10-18 02:13:44.361087 (MainThread): Completed successfully
2021-10-18 02:13:44.361794 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-18 02:13:44.362586 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26e0c1e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa26e1128d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2754dc470>]}
2021-10-18 02:13:44.363436 (MainThread): Flushing usage events
2021-10-18 02:16:14.328393 (MainThread): Running with dbt=0.21.0
2021-10-18 02:16:14.617790 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='clean', write_json=True)
2021-10-18 02:16:14.618195 (MainThread): Tracking: tracking
2021-10-18 02:16:14.618952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3937d208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3937d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3937d2b0>]}
2021-10-18 02:16:14.619322 (MainThread): Checking target/*
2021-10-18 02:16:14.620132 (MainThread):  Cleaned target/*
2021-10-18 02:16:14.620379 (MainThread): Checking dbt_modules/*
2021-10-18 02:16:14.620632 (MainThread):  Cleaned dbt_modules/*
2021-10-18 02:16:14.620781 (MainThread): Finished cleaning all paths.
2021-10-18 02:16:14.621028 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3937d208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3937d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d3937d278>]}
2021-10-18 02:16:14.621261 (MainThread): Flushing usage events
2021-10-18 02:24:23.510536 (MainThread): Running with dbt=0.21.0
2021-10-18 02:24:23.828593 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:24:23.829509 (MainThread): Tracking: tracking
2021-10-18 02:24:23.830556 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e58c32e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e58c34e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e58c34a8>]}
2021-10-18 02:24:23.843790 (MainThread): Partial parsing not enabled
2021-10-18 02:24:23.851063 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:24:23.876658 (MainThread): Parsing macros/etc.sql
2021-10-18 02:24:23.878764 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:24:23.884700 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:24:23.895566 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:24:23.898401 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:24:23.900235 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:24:23.902930 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:24:23.920264 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:24:23.923879 (MainThread): Parsing macros/core.sql
2021-10-18 02:24:23.927920 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:24:23.938677 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:24:23.946540 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:24:23.969898 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:24:23.975168 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:24:23.982204 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:24:23.997391 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:24:23.999297 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:24:24.034712 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:24:24.053460 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:24:24.074637 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:24:24.076655 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:24:24.087311 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:24:24.095136 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:24:24.096360 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:24:24.099047 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:24:24.109034 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:24:24.110809 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:24:24.112636 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:24:24.114196 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:24:24.115850 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:24:24.169669 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:24:24.171985 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:24:24.173711 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:24:24.176350 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:24:24.393955 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:24:24.407956 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:24:24.412123 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:24:24.485291 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:24:24.488155 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:24:24.490698 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:24:24.492668 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:24:24.508395 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e047cda-a223-4e71-b5cf-6cbc98262e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e575dfd0>]}
2021-10-18 02:24:24.515032 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e047cda-a223-4e71-b5cf-6cbc98262e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e58c3fd0>]}
2021-10-18 02:24:24.515425 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:24:24.516522 (MainThread): 
2021-10-18 02:24:24.516981 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:24:24.518080 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:24:24.518394 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:24:24.936017 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:24:24.936645 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:24:24.948963 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:24:25.462986 (MainThread): 22:24:25 | Concurrency: 1 threads (target='dev')
2021-10-18 02:24:25.463559 (MainThread): 22:24:25 | 
2021-10-18 02:24:25.467073 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:24:25.468002 (Thread-1): 22:24:25 | 1 of 3 START view model dbt_jessie.customers......................... [RUN]
2021-10-18 02:24:25.469272 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:24:25.469973 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:24:25.472086 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54382), raddr=('142.250.176.202', 443)>
2021-10-18 02:24:25.473052 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54032), raddr=('142.250.80.10', 443)>
2021-10-18 02:24:25.474002 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54386), raddr=('142.250.176.202', 443)>
2021-10-18 02:24:25.474942 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54036), raddr=('142.250.80.10', 443)>
2021-10-18 02:24:25.479371 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 02:24:25.480589 (Thread-1): finished collecting timing info
2021-10-18 02:24:25.538731 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-10-18 02:24:25.539496 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:24:25.544659 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-10-18 02:24:26.704058 (Thread-1): finished collecting timing info
2021-10-18 02:24:26.705398 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e047cda-a223-4e71-b5cf-6cbc98262e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e57ae198>]}
2021-10-18 02:24:26.706772 (Thread-1): 22:24:26 | 1 of 3 OK created view model dbt_jessie.customers.................... [OK in 1.24s]
2021-10-18 02:24:26.707376 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:24:26.707942 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:24:26.708942 (Thread-1): 22:24:26 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:24:26.709785 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:24:26.710229 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:24:26.711917 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54390), raddr=('142.250.176.202', 443)>
2021-10-18 02:24:26.712455 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54040), raddr=('142.250.80.10', 443)>
2021-10-18 02:24:26.716892 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:24:26.717706 (Thread-1): finished collecting timing info
2021-10-18 02:24:26.751760 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:24:26.759891 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:24:27.187485 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:24:27.188267 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:24:29.558724 (Thread-1): finished collecting timing info
2021-10-18 02:24:29.560196 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e047cda-a223-4e71-b5cf-6cbc98262e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e57ae240>]}
2021-10-18 02:24:29.561483 (Thread-1): 22:24:29 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.85s]
2021-10-18 02:24:29.562157 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:24:29.563633 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:24:29.564514 (Thread-1): 22:24:29 | 3 of 3 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:24:29.565388 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:24:29.565809 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:24:29.571052 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:24:29.571770 (Thread-1): finished collecting timing info
2021-10-18 02:24:29.577352 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:24:29.578342 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:24:29.593150 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1;


2021-10-18 02:24:30.481901 (Thread-1): finished collecting timing info
2021-10-18 02:24:30.483332 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e047cda-a223-4e71-b5cf-6cbc98262e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e46b0898>]}
2021-10-18 02:24:30.484339 (Thread-1): 22:24:30 | 3 of 3 OK created view model dbt_jessie.my_second_dbt_model.......... [OK in 0.92s]
2021-10-18 02:24:30.484958 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:24:30.586292 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:24:30.587441 (MainThread): 22:24:30 | 
2021-10-18 02:24:30.587996 (MainThread): 22:24:30 | Finished running 2 view models, 1 table model in 6.07s.
2021-10-18 02:24:30.588465 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:24:30.588798 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:24:30.591066 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54398), raddr=('142.250.176.202', 443)>
2021-10-18 02:24:30.591637 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54048), raddr=('142.250.80.10', 443)>
2021-10-18 02:24:30.601045 (MainThread): 
2021-10-18 02:24:30.601816 (MainThread): Completed successfully
2021-10-18 02:24:30.602497 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-18 02:24:30.603125 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e573a7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e46f7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08e469f160>]}
2021-10-18 02:24:30.603962 (MainThread): Flushing usage events
2021-10-18 02:25:39.663740 (MainThread): Running with dbt=0.21.0
2021-10-18 02:25:39.961374 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:25:39.962264 (MainThread): Tracking: tracking
2021-10-18 02:25:39.963264 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b746320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b746550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b746518>]}
2021-10-18 02:25:39.974922 (MainThread): Partial parsing not enabled
2021-10-18 02:25:39.982257 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:25:40.007021 (MainThread): Parsing macros/etc.sql
2021-10-18 02:25:40.009111 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:25:40.014944 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:25:40.024686 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:25:40.027328 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:25:40.029092 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:25:40.032238 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:25:40.047888 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:25:40.050999 (MainThread): Parsing macros/core.sql
2021-10-18 02:25:40.054697 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:25:40.064708 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:25:40.071873 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:25:40.093819 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:25:40.099138 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:25:40.106212 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:25:40.119909 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:25:40.121755 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:25:40.152434 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:25:40.170393 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:25:40.189170 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:25:40.191070 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:25:40.201460 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:25:40.208953 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:25:40.210215 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:25:40.212937 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:25:40.221538 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:25:40.223234 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:25:40.225053 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:25:40.226594 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:25:40.228133 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:25:40.279174 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:25:40.280739 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:25:40.282342 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:25:40.284728 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:25:40.487232 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:25:40.500133 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:25:40.504125 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:25:40.574767 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:25:40.577050 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:25:40.579351 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:25:40.581577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:25:40.590534 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example.example

2021-10-18 02:25:40.595969 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6228645c-8a65-4fae-aa29-ce802f4781e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b5c13c8>]}
2021-10-18 02:25:40.600722 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6228645c-8a65-4fae-aa29-ce802f4781e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b76d780>]}
2021-10-18 02:25:40.601097 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:25:40.602269 (MainThread): 
2021-10-18 02:25:40.602767 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:25:40.604273 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:25:40.604868 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:25:41.140468 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:25:41.141236 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:25:41.154894 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:25:41.651217 (MainThread): 22:25:41 | Concurrency: 1 threads (target='dev')
2021-10-18 02:25:41.651816 (MainThread): 22:25:41 | 
2021-10-18 02:25:41.655286 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:25:41.656093 (Thread-1): 22:25:41 | 1 of 3 START view model dbt_jessie.customers......................... [RUN]
2021-10-18 02:25:41.656959 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:25:41.657424 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:25:41.658862 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54422), raddr=('142.250.176.202', 443)>
2021-10-18 02:25:41.659386 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54072), raddr=('142.250.80.10', 443)>
2021-10-18 02:25:41.660012 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54426), raddr=('142.250.176.202', 443)>
2021-10-18 02:25:41.660465 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54076), raddr=('142.250.80.10', 443)>
2021-10-18 02:25:41.663347 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 02:25:41.664198 (Thread-1): finished collecting timing info
2021-10-18 02:25:41.724020 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-10-18 02:25:41.724613 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:25:41.730589 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-10-18 02:25:42.995022 (Thread-1): finished collecting timing info
2021-10-18 02:25:42.996131 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6228645c-8a65-4fae-aa29-ce802f4781e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b628d30>]}
2021-10-18 02:25:42.997055 (Thread-1): 22:25:42 | 1 of 3 OK created view model dbt_jessie.customers.................... [OK in 1.34s]
2021-10-18 02:25:42.997563 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:25:42.998086 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:25:42.998880 (Thread-1): 22:25:42 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:25:42.999763 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:25:43.000498 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:25:43.002186 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54430), raddr=('142.250.176.202', 443)>
2021-10-18 02:25:43.002720 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54080), raddr=('142.250.80.10', 443)>
2021-10-18 02:25:43.006833 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:25:43.007582 (Thread-1): finished collecting timing info
2021-10-18 02:25:43.041265 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:25:43.048530 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:25:43.626295 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:25:43.627180 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:25:45.747539 (Thread-1): finished collecting timing info
2021-10-18 02:25:45.748696 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6228645c-8a65-4fae-aa29-ce802f4781e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b628710>]}
2021-10-18 02:25:45.749731 (Thread-1): 22:25:45 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.75s]
2021-10-18 02:25:45.750277 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:25:45.751420 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:25:45.752357 (Thread-1): 22:25:45 | 3 of 3 START table model dbt_jessie.my_second_dbt_model.............. [RUN]
2021-10-18 02:25:45.753758 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:25:45.754281 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:25:45.759571 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:25:45.760349 (Thread-1): finished collecting timing info
2021-10-18 02:25:45.764092 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:25:45.777756 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:25:46.359896 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:25:46.565399 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:25:46.566438 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  
  
  OPTIONS()
  as (
    -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1
  );
    
2021-10-18 02:25:48.989680 (Thread-1): finished collecting timing info
2021-10-18 02:25:48.990780 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6228645c-8a65-4fae-aa29-ce802f4781e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc778cde2b0>]}
2021-10-18 02:25:48.991678 (Thread-1): 22:25:48 | 3 of 3 OK created table model dbt_jessie.my_second_dbt_model......... [CREATE TABLE (1.0 rows, 8.0 Bytes processed) in 3.24s]
2021-10-18 02:25:48.992167 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:25:49.080479 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:25:49.081802 (MainThread): 22:25:49 | 
2021-10-18 02:25:49.082548 (MainThread): 22:25:49 | Finished running 1 view model, 2 table models in 8.48s.
2021-10-18 02:25:49.083256 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:25:49.083850 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:25:49.095464 (MainThread): 
2021-10-18 02:25:49.096275 (MainThread): Completed successfully
2021-10-18 02:25:49.097086 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-18 02:25:49.098199 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b76da58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc778d2c198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc77b697198>]}
2021-10-18 02:25:49.099392 (MainThread): Flushing usage events
2021-10-18 02:26:49.073909 (MainThread): Running with dbt=0.21.0
2021-10-18 02:26:49.367920 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:26:49.368891 (MainThread): Tracking: tracking
2021-10-18 02:26:49.369991 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503a487320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503a487518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503a4874e0>]}
2021-10-18 02:26:49.381636 (MainThread): Partial parsing not enabled
2021-10-18 02:26:49.389039 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:26:49.412607 (MainThread): Parsing macros/etc.sql
2021-10-18 02:26:49.414960 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:26:49.428294 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:26:49.438242 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:26:49.441112 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:26:49.442901 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:26:49.445632 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:26:49.461750 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:26:49.464720 (MainThread): Parsing macros/core.sql
2021-10-18 02:26:49.468527 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:26:49.478624 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:26:49.485519 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:26:49.509906 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:26:49.514114 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:26:49.521338 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:26:49.535335 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:26:49.537366 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:26:49.567822 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:26:49.585584 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:26:49.605530 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:26:49.607531 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:26:49.617666 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:26:49.625328 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:26:49.626505 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:26:49.629144 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:26:49.638015 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:26:49.639887 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:26:49.641768 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:26:49.643315 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:26:49.644844 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:26:49.696407 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:26:49.698065 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:26:49.699468 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:26:49.701862 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:26:49.904862 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:26:49.918434 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:26:49.922826 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:26:49.992486 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:26:49.994484 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:26:49.996522 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:26:49.998542 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:26:50.010215 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example.example

2021-10-18 02:26:50.015751 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42736518-d0c3-4ff8-8b92-c0bb7b627700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503a4acb70>]}
2021-10-18 02:26:50.020465 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42736518-d0c3-4ff8-8b92-c0bb7b627700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503a4b3828>]}
2021-10-18 02:26:50.020953 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:26:50.022555 (MainThread): 
2021-10-18 02:26:50.023106 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:26:50.024622 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:26:50.025147 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:26:50.568825 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:26:50.569595 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:26:50.581341 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:26:50.977519 (MainThread): 22:26:50 | Concurrency: 1 threads (target='dev')
2021-10-18 02:26:50.978158 (MainThread): 22:26:50 | 
2021-10-18 02:26:50.981739 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:26:50.982518 (Thread-1): 22:26:50 | 1 of 3 START view model dbt_jessie.customers......................... [RUN]
2021-10-18 02:26:50.983391 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:26:50.983880 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:26:50.985387 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54474), raddr=('142.250.176.202', 443)>
2021-10-18 02:26:50.985975 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54124), raddr=('142.250.80.10', 443)>
2021-10-18 02:26:50.986592 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54478), raddr=('142.250.176.202', 443)>
2021-10-18 02:26:50.987136 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54128), raddr=('142.250.80.10', 443)>
2021-10-18 02:26:51.004028 (Thread-1): finished collecting timing info
2021-10-18 02:26:51.005504 (Thread-1): Compilation Error in model customers (models/customers.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'congif' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/compilation.py", line 386, in _compile_node
    node,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in model customers (models/customers.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-18 02:26:51.010595 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42736518-d0c3-4ff8-8b92-c0bb7b627700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503a359f60>]}
2021-10-18 02:26:51.011770 (Thread-1): 22:26:51 | 1 of 3 ERROR creating view model dbt_jessie.customers................ [ERROR in 0.03s]
2021-10-18 02:26:51.012464 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:26:51.013067 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:26:51.014104 (Thread-1): 22:26:51 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:26:51.014989 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:26:51.015541 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:26:51.020525 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:26:51.021372 (Thread-1): finished collecting timing info
2021-10-18 02:26:51.061146 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:26:51.067498 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:26:51.635539 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:26:51.636454 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:26:54.048246 (Thread-1): finished collecting timing info
2021-10-18 02:26:54.049352 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42736518-d0c3-4ff8-8b92-c0bb7b627700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503a3cbbe0>]}
2021-10-18 02:26:54.050244 (Thread-1): 22:26:54 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 3.03s]
2021-10-18 02:26:54.050743 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:26:54.051948 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:26:54.052664 (Thread-1): 22:26:54 | 3 of 3 START table model dbt_jessie.my_second_dbt_model.............. [RUN]
2021-10-18 02:26:54.053434 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:26:54.053815 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:26:54.058616 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:26:54.059437 (Thread-1): finished collecting timing info
2021-10-18 02:26:54.063032 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:26:54.074268 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:26:54.561915 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:26:54.563177 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  
  
  OPTIONS()
  as (
    -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1
  );
    
2021-10-18 02:26:56.813795 (Thread-1): finished collecting timing info
2021-10-18 02:26:56.814949 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42736518-d0c3-4ff8-8b92-c0bb7b627700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503d9e5a90>]}
2021-10-18 02:26:56.815885 (Thread-1): 22:26:56 | 3 of 3 OK created table model dbt_jessie.my_second_dbt_model......... [CREATE TABLE (1.0 rows, 8.0 Bytes processed) in 2.76s]
2021-10-18 02:26:56.816434 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:26:56.896942 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:26:56.898062 (MainThread): 22:26:56 | 
2021-10-18 02:26:56.898674 (MainThread): 22:26:56 | Finished running 1 view model, 2 table models in 6.88s.
2021-10-18 02:26:56.899239 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:26:56.899706 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:26:56.910980 (MainThread): 
2021-10-18 02:26:56.911536 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 02:26:56.911976 (MainThread): 
2021-10-18 02:26:56.912402 (MainThread): Compilation Error in model customers (models/customers.sql)
2021-10-18 02:26:56.912790 (MainThread):   'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-18 02:26:56.913274 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-18 02:26:56.913960 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f503826ccc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5038200780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5038200c50>]}
2021-10-18 02:26:56.914714 (MainThread): Flushing usage events
2021-10-18 02:27:34.148803 (MainThread): Running with dbt=0.21.0
2021-10-18 02:27:34.463908 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:27:34.464749 (MainThread): Tracking: tracking
2021-10-18 02:27:34.465920 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d57483320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d57483518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d574834e0>]}
2021-10-18 02:27:34.478025 (MainThread): Partial parsing not enabled
2021-10-18 02:27:34.485233 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:27:34.509875 (MainThread): Parsing macros/etc.sql
2021-10-18 02:27:34.511835 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:27:34.517576 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:27:34.528566 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:27:34.531460 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:27:34.533593 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:27:34.536672 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:27:34.553054 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:27:34.556026 (MainThread): Parsing macros/core.sql
2021-10-18 02:27:34.560972 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:27:34.571589 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:27:34.578690 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:27:34.602684 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:27:34.607314 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:27:34.614352 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:27:34.629245 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:27:34.631045 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:27:34.665663 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:27:34.684322 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:27:34.705368 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:27:34.707575 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:27:34.718759 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:27:34.727620 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:27:34.728875 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:27:34.731598 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:27:34.741298 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:27:34.743093 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:27:34.745036 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:27:34.746547 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:27:34.748084 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:27:34.801975 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:27:34.803730 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:27:34.805076 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:27:34.807924 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:27:35.022572 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:27:35.037826 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:27:35.042676 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:27:35.115227 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:27:35.117550 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:27:35.119719 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:27:35.121498 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:27:35.137252 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '514503b7-6e8e-481b-b564-fc3732a7f350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d57423c18>]}
2021-10-18 02:27:35.142386 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '514503b7-6e8e-481b-b564-fc3732a7f350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d574a49e8>]}
2021-10-18 02:27:35.142772 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:27:35.143931 (MainThread): 
2021-10-18 02:27:35.144399 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:27:35.145546 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:27:35.145815 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:27:35.626167 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:27:35.626962 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:27:35.639067 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:27:36.082443 (MainThread): 22:27:36 | Concurrency: 1 threads (target='dev')
2021-10-18 02:27:36.083128 (MainThread): 22:27:36 | 
2021-10-18 02:27:36.086569 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:27:36.087383 (Thread-1): 22:27:36 | 1 of 3 START table model dbt_jessie.customers........................ [RUN]
2021-10-18 02:27:36.088252 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:27:36.088715 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:27:36.090275 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54498), raddr=('142.250.176.202', 443)>
2021-10-18 02:27:36.090950 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 54148), raddr=('142.250.80.10', 443)>
2021-10-18 02:27:36.091600 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54502), raddr=('142.250.176.202', 443)>
2021-10-18 02:27:36.092230 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37460), raddr=('142.250.80.42', 443)>
2021-10-18 02:27:36.100691 (Thread-1): finished collecting timing info
2021-10-18 02:27:36.102153 (Thread-1): Compilation Error in model customers (models/customers.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'congif' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/compilation.py", line 386, in _compile_node
    node,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in model customers (models/customers.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-18 02:27:36.105617 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514503b7-6e8e-481b-b564-fc3732a7f350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d57340390>]}
2021-10-18 02:27:36.106627 (Thread-1): 22:27:36 | 1 of 3 ERROR creating table model dbt_jessie.customers............... [ERROR in 0.02s]
2021-10-18 02:27:36.107388 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:27:36.108353 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:27:36.109453 (Thread-1): 22:27:36 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:27:36.110922 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:27:36.111407 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:27:36.118569 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:27:36.119443 (Thread-1): finished collecting timing info
2021-10-18 02:27:36.158473 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:27:36.163878 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:27:36.696355 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:27:36.697447 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:27:38.904962 (Thread-1): finished collecting timing info
2021-10-18 02:27:38.905562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514503b7-6e8e-481b-b564-fc3732a7f350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d57358c50>]}
2021-10-18 02:27:38.906110 (Thread-1): 22:27:38 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.80s]
2021-10-18 02:27:38.906436 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:27:38.907092 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:27:38.907496 (Thread-1): 22:27:38 | 3 of 3 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:27:38.907991 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:27:38.908212 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:27:38.911042 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:27:38.911479 (Thread-1): finished collecting timing info
2021-10-18 02:27:38.931869 (Thread-1): finished collecting timing info
2021-10-18 02:27:38.932374 (Thread-1): Compilation Error in model my_second_dbt_model (models/example/my_second_dbt_model.sql)
  Trying to create view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model my_second_dbt_model (models/example/my_second_dbt_model.sql)
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 1017, in inner
    raise exc
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 1014, in inner
    return func(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 686, in relation_wrong_type
    model)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_second_dbt_model (models/example/my_second_dbt_model.sql)
  Trying to create view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model my_second_dbt_model (models/example/my_second_dbt_model.sql)
2021-10-18 02:27:38.933728 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514503b7-6e8e-481b-b564-fc3732a7f350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d549f94e0>]}
2021-10-18 02:27:38.934211 (Thread-1): 22:27:38 | 3 of 3 ERROR creating view model dbt_jessie.my_second_dbt_model...... [ERROR in 0.03s]
2021-10-18 02:27:38.934452 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:27:38.996633 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:27:38.997213 (MainThread): 22:27:38 | 
2021-10-18 02:27:38.997461 (MainThread): 22:27:38 | Finished running 2 table models, 1 view model in 3.85s.
2021-10-18 02:27:38.997651 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:27:38.997809 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:27:39.002596 (MainThread): 
2021-10-18 02:27:39.002879 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-18 02:27:39.003126 (MainThread): 
2021-10-18 02:27:39.003340 (MainThread): Compilation Error in model customers (models/customers.sql)
2021-10-18 02:27:39.003578 (MainThread):   'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-18 02:27:39.003772 (MainThread): 
2021-10-18 02:27:39.003963 (MainThread): Compilation Error in model my_second_dbt_model (models/example/my_second_dbt_model.sql)
2021-10-18 02:27:39.004155 (MainThread):   Trying to create view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-10-18 02:27:39.004342 (MainThread):   
2021-10-18 02:27:39.004494 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2021-10-18 02:27:39.004642 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2021-10-18 02:27:39.004789 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2021-10-18 02:27:39.004985 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2021-10-18 02:27:39.005142 (MainThread):   > called by model my_second_dbt_model (models/example/my_second_dbt_model.sql)
2021-10-18 02:27:39.005330 (MainThread): 
Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
2021-10-18 02:27:39.005601 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5c792b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d54a01fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d54a01470>]}
2021-10-18 02:27:39.006361 (MainThread): Flushing usage events
2021-10-18 02:27:52.977716 (MainThread): Running with dbt=0.21.0
2021-10-18 02:27:53.290873 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:27:53.301595 (MainThread): Tracking: tracking
2021-10-18 02:27:53.302749 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6eb68550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6eb33748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb73034128>]}
2021-10-18 02:27:53.314658 (MainThread): Partial parsing not enabled
2021-10-18 02:27:53.322499 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:27:53.347721 (MainThread): Parsing macros/etc.sql
2021-10-18 02:27:53.349944 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:27:53.355907 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:27:53.367680 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:27:53.370765 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:27:53.373207 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:27:53.376094 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:27:53.391916 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:27:53.394944 (MainThread): Parsing macros/core.sql
2021-10-18 02:27:53.399243 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:27:53.410008 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:27:53.416865 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:27:53.440711 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:27:53.444832 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:27:53.452034 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:27:53.466819 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:27:53.468940 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:27:53.500080 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:27:53.517889 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:27:53.538514 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:27:53.540640 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:27:53.553889 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:27:53.562054 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:27:53.563262 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:27:53.566106 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:27:53.575634 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:27:53.577427 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:27:53.579357 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:27:53.580992 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:27:53.582737 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:27:53.636546 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:27:53.638718 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:27:53.640232 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:27:53.642721 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:27:53.865980 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:27:53.880987 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:27:53.885520 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:27:53.959122 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:27:53.961134 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:27:53.963296 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:27:53.965402 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:27:53.980957 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b9500b7-750d-419d-9eb1-16d7beb188b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6eae36d8>]}
2021-10-18 02:27:53.985957 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b9500b7-750d-419d-9eb1-16d7beb188b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6eb22438>]}
2021-10-18 02:27:53.986381 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:27:53.987588 (MainThread): 
2021-10-18 02:27:53.988198 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:27:53.989713 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:27:53.990071 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:27:54.468328 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:27:54.468936 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:27:54.481201 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:27:54.482616 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54514), raddr=('142.250.176.202', 443)>
2021-10-18 02:27:54.483185 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37472), raddr=('142.250.80.42', 443)>
2021-10-18 02:27:54.877344 (MainThread): 22:27:54 | Concurrency: 1 threads (target='dev')
2021-10-18 02:27:54.878067 (MainThread): 22:27:54 | 
2021-10-18 02:27:54.881805 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:27:54.882664 (Thread-1): 22:27:54 | 1 of 3 START table model dbt_jessie.customers........................ [RUN]
2021-10-18 02:27:54.883716 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:27:54.884171 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:27:54.891063 (Thread-1): finished collecting timing info
2021-10-18 02:27:54.892093 (Thread-1): Compilation Error in model customers (models/customers.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 517, in catch_jinja
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'congif' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 285, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/compile.py", line 33, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/compilation.py", line 543, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/compilation.py", line 386, in _compile_node
    node,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 522, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in model customers (models/customers.sql)
  'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-18 02:27:54.895425 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9500b7-750d-419d-9eb1-16d7beb188b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6eae3160>]}
2021-10-18 02:27:54.896436 (Thread-1): 22:27:54 | 1 of 3 ERROR creating table model dbt_jessie.customers............... [ERROR in 0.01s]
2021-10-18 02:27:54.896934 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:27:54.897431 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:27:54.898010 (Thread-1): 22:27:54 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:27:54.899239 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:27:54.899777 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:27:54.905346 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:27:54.906363 (Thread-1): finished collecting timing info
2021-10-18 02:27:54.949742 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:27:54.955576 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:27:55.536570 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:27:55.537559 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:27:57.652943 (Thread-1): finished collecting timing info
2021-10-18 02:27:57.654064 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9500b7-750d-419d-9eb1-16d7beb188b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6ea6a438>]}
2021-10-18 02:27:57.655017 (Thread-1): 22:27:57 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.76s]
2021-10-18 02:27:57.655617 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:27:57.656727 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:27:57.657480 (Thread-1): 22:27:57 | 3 of 3 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:27:57.658756 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:27:57.659274 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:27:57.664479 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:27:57.665253 (Thread-1): finished collecting timing info
2021-10-18 02:27:57.704106 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:27:57.711762 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:27:58.270149 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:27:58.271101 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1;


2021-10-18 02:28:07.102932 (Thread-1): finished collecting timing info
2021-10-18 02:28:07.103573 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9500b7-750d-419d-9eb1-16d7beb188b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6ea99668>]}
2021-10-18 02:28:07.104037 (Thread-1): 22:28:07 | 3 of 3 OK created view model dbt_jessie.my_second_dbt_model.......... [OK in 9.45s]
2021-10-18 02:28:07.104279 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:28:07.117542 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:28:07.118417 (MainThread): 22:28:07 | 
2021-10-18 02:28:07.118827 (MainThread): 22:28:07 | Finished running 2 table models, 1 view model in 13.13s.
2021-10-18 02:28:07.119201 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:28:07.119563 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:28:07.125154 (MainThread): 
2021-10-18 02:28:07.125472 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 02:28:07.125770 (MainThread): 
2021-10-18 02:28:07.126015 (MainThread): Compilation Error in model customers (models/customers.sql)
2021-10-18 02:28:07.126220 (MainThread):   'congif' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2021-10-18 02:28:07.126409 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-18 02:28:07.126744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6ea75710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6c0c6dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb6c12beb8>]}
2021-10-18 02:28:07.127066 (MainThread): Flushing usage events
2021-10-18 02:28:27.602073 (MainThread): Running with dbt=0.21.0
2021-10-18 02:28:27.914631 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:28:27.915753 (MainThread): Tracking: tracking
2021-10-18 02:28:27.917195 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d9a92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d9a9518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d9a94e0>]}
2021-10-18 02:28:27.930135 (MainThread): Partial parsing not enabled
2021-10-18 02:28:27.938340 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:28:27.964415 (MainThread): Parsing macros/etc.sql
2021-10-18 02:28:27.968522 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:28:27.974341 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:28:27.985677 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:28:27.988984 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:28:27.991031 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:28:27.994059 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:28:28.010913 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:28:28.013908 (MainThread): Parsing macros/core.sql
2021-10-18 02:28:28.019147 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:28:28.030200 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:28:28.037725 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:28:28.061517 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:28:28.066665 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:28:28.073899 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:28:28.089041 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:28:28.090967 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:28:28.121913 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:28:28.140372 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:28:28.160320 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:28:28.162701 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:28:28.173425 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:28:28.181021 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:28:28.182429 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:28:28.186173 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:28:28.195553 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:28:28.197614 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:28:28.200022 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:28:28.202077 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:28:28.203914 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:28:28.258088 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:28:28.259836 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:28:28.261611 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:28:28.264259 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:28:28.478429 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:28:28.492488 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:28:28.497225 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:28:28.571558 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:28:28.574401 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:28:28.576696 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:28:28.579008 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:28:28.594328 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64772736-2f56-4dcf-981d-e4334460d6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d846f28>]}
2021-10-18 02:28:28.600161 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64772736-2f56-4dcf-981d-e4334460d6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d8227f0>]}
2021-10-18 02:28:28.600773 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:28:28.602070 (MainThread): 
2021-10-18 02:28:28.602608 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:28:28.603877 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:28:28.604196 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:28:29.069120 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:28:29.069815 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:28:29.080941 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:28:29.502906 (MainThread): 22:28:29 | Concurrency: 1 threads (target='dev')
2021-10-18 02:28:29.503578 (MainThread): 22:28:29 | 
2021-10-18 02:28:29.507048 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:28:29.507950 (Thread-1): 22:28:29 | 1 of 3 START table model dbt_jessie.customers........................ [RUN]
2021-10-18 02:28:29.509132 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:28:29.509804 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:28:29.511803 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54534), raddr=('142.250.176.202', 443)>
2021-10-18 02:28:29.512741 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37492), raddr=('142.250.80.42', 443)>
2021-10-18 02:28:29.513469 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54538), raddr=('142.250.176.202', 443)>
2021-10-18 02:28:29.514126 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37496), raddr=('142.250.80.42', 443)>
2021-10-18 02:28:29.517993 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 02:28:29.518867 (Thread-1): finished collecting timing info
2021-10-18 02:28:29.559747 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:28:29.565998 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:28:30.204521 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:28:30.457420 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-10-18 02:28:30.458546 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-10-18 02:28:33.288518 (Thread-1): finished collecting timing info
2021-10-18 02:28:33.289901 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64772736-2f56-4dcf-981d-e4334460d6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d910c88>]}
2021-10-18 02:28:33.291011 (Thread-1): 22:28:33 | 1 of 3 OK created table model dbt_jessie.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.78s]
2021-10-18 02:28:33.291575 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:28:33.292322 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:28:33.293375 (Thread-1): 22:28:33 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:28:33.294366 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:28:33.294830 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:28:33.300587 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:28:33.301578 (Thread-1): finished collecting timing info
2021-10-18 02:28:33.306442 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:28:33.318237 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:28:33.717342 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:28:33.718453 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:28:36.016515 (Thread-1): finished collecting timing info
2021-10-18 02:28:36.017800 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64772736-2f56-4dcf-981d-e4334460d6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1c7c91d0>]}
2021-10-18 02:28:36.018699 (Thread-1): 22:28:36 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.72s]
2021-10-18 02:28:36.019194 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:28:36.020224 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:28:36.020811 (Thread-1): 22:28:36 | 3 of 3 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:28:36.021816 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:28:36.022401 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:28:36.028842 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:28:36.029762 (Thread-1): finished collecting timing info
2021-10-18 02:28:36.069696 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:28:36.070679 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:28:36.079958 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1;


2021-10-18 02:29:06.833881 (Thread-1): finished collecting timing info
2021-10-18 02:29:06.835542 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64772736-2f56-4dcf-981d-e4334460d6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1c78d550>]}
2021-10-18 02:29:06.836757 (Thread-1): 22:29:06 | 3 of 3 OK created view model dbt_jessie.my_second_dbt_model.......... [OK in 30.81s]
2021-10-18 02:29:06.837507 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:29:06.920543 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:29:06.921638 (MainThread): 22:29:06 | 
2021-10-18 02:29:06.922109 (MainThread): 22:29:06 | Finished running 2 table models, 1 view model in 38.32s.
2021-10-18 02:29:06.922494 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:29:06.922840 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:29:06.933439 (MainThread): 
2021-10-18 02:29:06.934045 (MainThread): Completed successfully
2021-10-18 02:29:06.934659 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-18 02:29:06.935220 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d8220b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d949b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1d88c0b8>]}
2021-10-18 02:29:06.935809 (MainThread): Flushing usage events
2021-10-18 02:29:19.311861 (MainThread): Running with dbt=0.21.0
2021-10-18 02:29:19.623755 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:29:19.634606 (MainThread): Tracking: tracking
2021-10-18 02:29:19.635757 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52d2a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5720f128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52d0f748>]}
2021-10-18 02:29:19.648431 (MainThread): Partial parsing not enabled
2021-10-18 02:29:19.655541 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:29:19.681249 (MainThread): Parsing macros/etc.sql
2021-10-18 02:29:19.683300 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:29:19.688846 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:29:19.700411 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:29:19.703411 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:29:19.705428 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:29:19.709293 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:29:19.724782 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:29:19.728279 (MainThread): Parsing macros/core.sql
2021-10-18 02:29:19.732205 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:29:19.743324 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:29:19.750211 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:29:19.775864 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:29:19.780153 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:29:19.787392 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:29:19.801586 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:29:19.803510 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:29:19.834658 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:29:19.852783 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:29:19.874073 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:29:19.876221 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:29:19.886448 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:29:19.894818 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:29:19.896073 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:29:19.898739 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:29:19.908202 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:29:19.910190 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:29:19.912144 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:29:19.913649 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:29:19.915222 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:29:19.969248 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:29:19.971095 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:29:19.972512 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:29:19.975648 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:29:20.190001 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:29:20.203409 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:29:20.208478 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:29:20.281308 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:29:20.283514 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:29:20.285653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:29:20.287595 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:29:20.302550 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d6376d1-fcda-40b0-8f12-03179bf36ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52d21ba8>]}
2021-10-18 02:29:20.307948 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d6376d1-fcda-40b0-8f12-03179bf36ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52d21898>]}
2021-10-18 02:29:20.308355 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:29:20.309579 (MainThread): 
2021-10-18 02:29:20.310034 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:29:20.311112 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:29:20.311383 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:29:20.793643 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:29:20.794294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:29:20.806050 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:29:20.808090 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54558), raddr=('142.250.176.202', 443)>
2021-10-18 02:29:20.808716 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37516), raddr=('142.250.80.42', 443)>
2021-10-18 02:29:21.247082 (MainThread): 22:29:21 | Concurrency: 1 threads (target='dev')
2021-10-18 02:29:21.247654 (MainThread): 22:29:21 | 
2021-10-18 02:29:21.251422 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:29:21.252295 (Thread-1): 22:29:21 | 1 of 3 START table model dbt_jessie.customers........................ [RUN]
2021-10-18 02:29:21.253249 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:29:21.253708 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:29:21.256642 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 02:29:21.257624 (Thread-1): finished collecting timing info
2021-10-18 02:29:21.307899 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:29:21.316432 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:29:21.864620 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-10-18 02:29:21.865602 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-10-18 02:29:24.800742 (Thread-1): finished collecting timing info
2021-10-18 02:29:24.801865 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d6376d1-fcda-40b0-8f12-03179bf36ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52c1e550>]}
2021-10-18 02:29:24.802794 (Thread-1): 22:29:24 | 1 of 3 OK created table model dbt_jessie.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.55s]
2021-10-18 02:29:24.803281 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:29:24.803813 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:29:24.804621 (Thread-1): 22:29:24 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:29:24.805476 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:29:24.805889 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:29:24.811395 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:29:24.812365 (Thread-1): finished collecting timing info
2021-10-18 02:29:24.816501 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:29:24.828543 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:29:25.235706 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:29:25.236712 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:29:27.858477 (Thread-1): finished collecting timing info
2021-10-18 02:29:27.859945 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d6376d1-fcda-40b0-8f12-03179bf36ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d502dee48>]}
2021-10-18 02:29:27.861290 (Thread-1): 22:29:27 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 3.05s]
2021-10-18 02:29:27.861929 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:29:27.863684 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:29:27.864733 (Thread-1): 22:29:27 | 3 of 3 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:29:27.865840 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:29:27.866325 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:29:27.871644 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:29:27.872642 (Thread-1): finished collecting timing info
2021-10-18 02:29:27.916271 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:29:27.917203 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:29:27.926849 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1;


2021-10-18 02:29:28.989005 (Thread-1): finished collecting timing info
2021-10-18 02:29:28.990730 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d6376d1-fcda-40b0-8f12-03179bf36ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d502fef28>]}
2021-10-18 02:29:28.991857 (Thread-1): 22:29:28 | 3 of 3 OK created view model dbt_jessie.my_second_dbt_model.......... [OK in 1.13s]
2021-10-18 02:29:28.992565 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:29:29.081324 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:29:29.082654 (MainThread): 22:29:29 | 
2021-10-18 02:29:29.083277 (MainThread): 22:29:29 | Finished running 2 table models, 1 view model in 8.77s.
2021-10-18 02:29:29.083806 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:29:29.084290 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:29:29.089957 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54566), raddr=('142.250.176.202', 443)>
2021-10-18 02:29:29.090605 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37524), raddr=('142.250.80.42', 443)>
2021-10-18 02:29:29.091214 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54570), raddr=('142.250.176.202', 443)>
2021-10-18 02:29:29.091754 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37528), raddr=('142.250.80.42', 443)>
2021-10-18 02:29:29.098013 (MainThread): 
2021-10-18 02:29:29.099092 (MainThread): Completed successfully
2021-10-18 02:29:29.100012 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-18 02:29:29.100975 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d5420cc18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d502fef28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d52cc7128>]}
2021-10-18 02:29:29.101649 (MainThread): Flushing usage events
2021-10-18 02:29:48.956156 (MainThread): Running with dbt=0.21.0
2021-10-18 02:29:49.269044 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:29:49.269921 (MainThread): Tracking: tracking
2021-10-18 02:29:49.270944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099516c2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099516c518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099516c4e0>]}
2021-10-18 02:29:49.283700 (MainThread): Partial parsing not enabled
2021-10-18 02:29:49.291340 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:29:49.315604 (MainThread): Parsing macros/etc.sql
2021-10-18 02:29:49.318244 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:29:49.324036 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:29:49.334874 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:29:49.337746 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:29:49.339509 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:29:49.342250 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:29:49.359187 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:29:49.362205 (MainThread): Parsing macros/core.sql
2021-10-18 02:29:49.366704 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:29:49.376843 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:29:49.384592 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:29:49.409478 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:29:49.413924 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:29:49.421613 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:29:49.436423 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:29:49.438259 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:29:49.469006 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:29:49.487339 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:29:49.507761 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:29:49.509752 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:29:49.521046 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:29:49.528606 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:29:49.529924 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:29:49.533628 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:29:49.542450 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:29:49.544320 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:29:49.546238 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:29:49.548371 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:29:49.550515 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:29:49.604113 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:29:49.605716 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:29:49.607037 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:29:49.609361 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:29:49.826480 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:29:49.841377 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:29:49.845933 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:29:49.920749 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:29:49.922900 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:29:49.925037 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:29:49.927104 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:29:49.941972 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8746d5b-63c8-413c-98f5-96e266ca82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09950ed518>]}
2021-10-18 02:29:49.946475 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8746d5b-63c8-413c-98f5-96e266ca82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09950a1a90>]}
2021-10-18 02:29:49.946896 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:29:49.948271 (MainThread): 
2021-10-18 02:29:49.948914 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:29:49.950466 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:29:49.950914 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:29:50.388373 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:29:50.389131 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:29:50.402948 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:29:50.900711 (MainThread): 22:29:50 | Concurrency: 1 threads (target='dev')
2021-10-18 02:29:50.901376 (MainThread): 22:29:50 | 
2021-10-18 02:29:50.904977 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:29:50.905827 (Thread-1): 22:29:50 | 1 of 3 START view model dbt_jessie.customers......................... [RUN]
2021-10-18 02:29:50.906791 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:29:50.907261 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:29:50.908969 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54582), raddr=('142.250.176.202', 443)>
2021-10-18 02:29:50.909631 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37540), raddr=('142.250.80.42', 443)>
2021-10-18 02:29:50.910140 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54586), raddr=('142.250.176.202', 443)>
2021-10-18 02:29:50.910561 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37544), raddr=('142.250.80.42', 443)>
2021-10-18 02:29:50.914766 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 02:29:50.915440 (Thread-1): finished collecting timing info
2021-10-18 02:29:50.938886 (Thread-1): finished collecting timing info
2021-10-18 02:29:50.939491 (Thread-1): Compilation Error in model customers (models/customers.sql)
  Trying to create view `dbttutorial2021`.`dbt_jessie`.`customers`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customers (models/customers.sql)
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 1017, in inner
    raise exc
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 1014, in inner
    return func(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 686, in relation_wrong_type
    model)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models/customers.sql)
  Trying to create view `dbttutorial2021`.`dbt_jessie`.`customers`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customers (models/customers.sql)
2021-10-18 02:29:50.941329 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8746d5b-63c8-413c-98f5-96e266ca82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0994ff6e80>]}
2021-10-18 02:29:50.941858 (Thread-1): 22:29:50 | 1 of 3 ERROR creating view model dbt_jessie.customers................ [ERROR in 0.03s]
2021-10-18 02:29:50.942122 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:29:50.942484 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:29:50.942995 (Thread-1): 22:29:50 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:29:50.943474 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:29:50.943703 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:29:50.946080 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:29:50.946513 (Thread-1): finished collecting timing info
2021-10-18 02:29:50.962036 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:29:50.967323 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:29:51.424351 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:29:51.424833 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:29:53.258232 (Thread-1): finished collecting timing info
2021-10-18 02:29:53.258787 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8746d5b-63c8-413c-98f5-96e266ca82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09950ae438>]}
2021-10-18 02:29:53.259267 (Thread-1): 22:29:53 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.32s]
2021-10-18 02:29:53.259527 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:29:53.260090 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:29:53.260393 (Thread-1): 22:29:53 | 3 of 3 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:29:53.260797 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:29:53.261044 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:29:53.263820 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:29:53.264362 (Thread-1): finished collecting timing info
2021-10-18 02:29:53.275133 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:29:53.276352 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:29:53.290606 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1;


2021-10-18 02:29:56.121110 (Thread-1): finished collecting timing info
2021-10-18 02:29:56.121911 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8746d5b-63c8-413c-98f5-96e266ca82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0994103160>]}
2021-10-18 02:29:56.122527 (Thread-1): 22:29:56 | 3 of 3 OK created view model dbt_jessie.my_second_dbt_model.......... [OK in 2.86s]
2021-10-18 02:29:56.122844 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:29:56.222473 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:29:56.223132 (MainThread): 22:29:56 | 
2021-10-18 02:29:56.223445 (MainThread): 22:29:56 | Finished running 2 view models, 1 table model in 6.27s.
2021-10-18 02:29:56.223643 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:29:56.223798 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:29:56.228501 (MainThread): 
2021-10-18 02:29:56.228803 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 02:29:56.229045 (MainThread): 
2021-10-18 02:29:56.229249 (MainThread): Compilation Error in model customers (models/customers.sql)
2021-10-18 02:29:56.229427 (MainThread):   Trying to create view `dbttutorial2021`.`dbt_jessie`.`customers`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-10-18 02:29:56.229597 (MainThread):   
2021-10-18 02:29:56.229786 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2021-10-18 02:29:56.230002 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2021-10-18 02:29:56.230225 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2021-10-18 02:29:56.230408 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2021-10-18 02:29:56.230548 (MainThread):   > called by model customers (models/customers.sql)
2021-10-18 02:29:56.230706 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-10-18 02:29:56.231047 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09950fdf98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09950aea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09950780b8>]}
2021-10-18 02:29:56.231329 (MainThread): Flushing usage events
2021-10-18 02:30:06.907709 (MainThread): Running with dbt=0.21.0
2021-10-18 02:30:07.200286 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:30:07.201164 (MainThread): Tracking: tracking
2021-10-18 02:30:07.202150 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c3d5588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c3da748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7eca1eb8>]}
2021-10-18 02:30:07.213721 (MainThread): Partial parsing not enabled
2021-10-18 02:30:07.221729 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:30:07.245004 (MainThread): Parsing macros/etc.sql
2021-10-18 02:30:07.247178 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:30:07.252497 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:30:07.263777 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:30:07.266584 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:30:07.268341 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:30:07.271044 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:30:07.285851 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:30:07.288659 (MainThread): Parsing macros/core.sql
2021-10-18 02:30:07.292450 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:30:07.302043 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:30:07.309069 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:30:07.331294 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:30:07.335421 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:30:07.342310 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:30:07.356001 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:30:07.357945 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:30:07.387962 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:30:07.405172 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:30:07.424217 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:30:07.426210 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:30:07.436332 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:30:07.443667 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:30:07.444815 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:30:07.447666 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:30:07.456132 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:30:07.457811 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:30:07.459652 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:30:07.461339 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:30:07.463072 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:30:07.514259 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:30:07.515913 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:30:07.517163 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:30:07.519387 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:30:07.715643 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:30:07.730481 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:30:07.734510 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:30:07.804117 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:30:07.806204 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:30:07.808272 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:30:07.810128 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 02:30:07.824444 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a72f489-9e73-4af4-8c66-9aca7d7e7ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c31f198>]}
2021-10-18 02:30:07.828955 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a72f489-9e73-4af4-8c66-9aca7d7e7ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c31f668>]}
2021-10-18 02:30:07.829339 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:30:07.830546 (MainThread): 
2021-10-18 02:30:07.831038 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:30:07.832186 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:30:07.832486 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:30:08.308637 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:30:08.309500 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:30:08.321851 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:30:08.323293 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54608), raddr=('142.250.176.202', 443)>
2021-10-18 02:30:08.323879 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37566), raddr=('142.250.80.42', 443)>
2021-10-18 02:30:08.820338 (MainThread): 22:30:08 | Concurrency: 1 threads (target='dev')
2021-10-18 02:30:08.821015 (MainThread): 22:30:08 | 
2021-10-18 02:30:08.825019 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:30:08.825820 (Thread-1): 22:30:08 | 1 of 3 START view model dbt_jessie.customers......................... [RUN]
2021-10-18 02:30:08.826720 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:30:08.827167 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:30:08.832630 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 02:30:08.833496 (Thread-1): finished collecting timing info
2021-10-18 02:30:08.882258 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:30:08.892058 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:30:09.460445 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-10-18 02:30:09.461343 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-10-18 02:30:10.132403 (Thread-1): finished collecting timing info
2021-10-18 02:30:10.133762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a72f489-9e73-4af4-8c66-9aca7d7e7ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c28ec88>]}
2021-10-18 02:30:10.134690 (Thread-1): 22:30:10 | 1 of 3 OK created view model dbt_jessie.customers.................... [OK in 1.31s]
2021-10-18 02:30:10.135173 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:30:10.135726 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:30:10.136676 (Thread-1): 22:30:10 | 2 of 3 START table model dbt_jessie.my_first_dbt_model............... [RUN]
2021-10-18 02:30:10.137573 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-10-18 02:30:10.138014 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-10-18 02:30:10.143435 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:30:10.144216 (Thread-1): finished collecting timing info
2021-10-18 02:30:10.178251 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:30:10.187327 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:30:10.591010 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-10-18 02:30:10.591958 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-10-18 02:30:14.964229 (Thread-1): finished collecting timing info
2021-10-18 02:30:14.965442 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a72f489-9e73-4af4-8c66-9aca7d7e7ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c2e70f0>]}
2021-10-18 02:30:14.966460 (Thread-1): 22:30:14 | 2 of 3 OK created table model dbt_jessie.my_first_dbt_model.......... [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 4.83s]
2021-10-18 02:30:14.967006 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-10-18 02:30:14.968368 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:30:14.969237 (Thread-1): 22:30:14 | 3 of 3 START view model dbt_jessie.my_second_dbt_model............... [RUN]
2021-10-18 02:30:14.970163 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-10-18 02:30:14.970616 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-10-18 02:30:14.976007 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:30:14.976809 (Thread-1): finished collecting timing info
2021-10-18 02:30:14.981424 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-10-18 02:30:14.982364 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:30:14.994185 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial2021`.`dbt_jessie`.`my_first_dbt_model`
where id = 1;


2021-10-18 02:30:28.704228 (Thread-1): finished collecting timing info
2021-10-18 02:30:28.705490 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a72f489-9e73-4af4-8c66-9aca7d7e7ebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f799710b8>]}
2021-10-18 02:30:28.706693 (Thread-1): 22:30:28 | 3 of 3 OK created view model dbt_jessie.my_second_dbt_model.......... [OK in 13.74s]
2021-10-18 02:30:28.707348 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-10-18 02:30:28.783867 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:30:28.784942 (MainThread): 22:30:28 | 
2021-10-18 02:30:28.785484 (MainThread): 22:30:28 | Finished running 2 view models, 1 table model in 20.95s.
2021-10-18 02:30:28.785994 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:30:28.786338 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-10-18 02:30:28.791766 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54616), raddr=('142.250.176.202', 443)>
2021-10-18 02:30:28.792473 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37574), raddr=('142.250.80.42', 443)>
2021-10-18 02:30:28.793196 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54620), raddr=('142.250.176.202', 443)>
2021-10-18 02:30:28.793759 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37578), raddr=('142.250.80.42', 443)>
2021-10-18 02:30:28.801473 (MainThread): 
2021-10-18 02:30:28.802152 (MainThread): Completed successfully
2021-10-18 02:30:28.802662 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-18 02:30:28.803295 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c35ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c376c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f7c2d2278>]}
2021-10-18 02:30:28.804019 (MainThread): Flushing usage events
2021-10-18 02:35:50.162316 (MainThread): Running with dbt=0.21.0
2021-10-18 02:35:50.454276 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:35:50.455099 (MainThread): Tracking: tracking
2021-10-18 02:35:50.456110 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23503be2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23503be470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23503be438>]}
2021-10-18 02:35:50.467474 (MainThread): Partial parsing not enabled
2021-10-18 02:35:50.474370 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:35:50.497484 (MainThread): Parsing macros/etc.sql
2021-10-18 02:35:50.499537 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:35:50.505198 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:35:50.515439 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:35:50.518222 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:35:50.520078 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:35:50.522806 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:35:50.540718 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:35:50.543920 (MainThread): Parsing macros/core.sql
2021-10-18 02:35:50.547939 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:35:50.558032 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:35:50.564798 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:35:50.586693 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:35:50.590868 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:35:50.597736 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:35:50.611840 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:35:50.613628 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:35:50.642801 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:35:50.659683 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:35:50.678931 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:35:50.680985 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:35:50.691143 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:35:50.698530 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:35:50.699661 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:35:50.702493 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:35:50.710892 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:35:50.712599 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:35:50.714439 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:35:50.716002 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:35:50.717575 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:35:50.768005 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:35:50.769680 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:35:50.771140 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:35:50.773482 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:35:50.971427 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:35:50.985512 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 02:35:50.989211 (MainThread): 1699: statically parsed stg_orders.sql
2021-10-18 02:35:50.989472 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:35:50.991854 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'a9aace69-b89e-4254-b186-ef93edb5d87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23502eb668>]}
2021-10-18 02:35:51.054413 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9aace69-b89e-4254-b186-ef93edb5d87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2350618208>]}
2021-10-18 02:35:51.058506 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9aace69-b89e-4254-b186-ef93edb5d87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23503ca8d0>]}
2021-10-18 02:35:51.058901 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:35:51.059776 (MainThread): 
2021-10-18 02:35:51.060195 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:35:51.061293 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:35:51.061540 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:35:51.563444 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:35:51.564224 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:35:51.575872 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:35:51.972831 (MainThread): 22:35:51 | Concurrency: 1 threads (target='dev')
2021-10-18 02:35:51.973499 (MainThread): 22:35:51 | 
2021-10-18 02:35:51.977050 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 02:35:51.978037 (Thread-1): 22:35:51 | 1 of 2 START table model dbt_jessie.stg_orders....................... [RUN]
2021-10-18 02:35:51.979230 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:35:51.979739 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 02:35:51.983278 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:35:51.984208 (Thread-1): finished collecting timing info
2021-10-18 02:35:52.060049 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:35:52.060504 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:35:52.065381 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id         as order_id,
    user_id    as customer_id,
    order_date as order_date,
    status     as status

from 'dbt_tutorial'.jaffle_shop.orders
  );
    
2021-10-18 02:35:52.687902 (Thread-1): Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]",)
2021-10-18 02:35:53.916525 (Thread-1): finished collecting timing info
2021-10-18 02:35:53.917649 (Thread-1): Database Error in model stg_orders (models/stg_orders.sql)
  Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]
  compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]

(job ID: 6507b907-d2da-45c1-8258-ea1dcdde3bc5)

                                                         -----Query Job SQL Follows-----                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
   2:
   3:
   4:  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    select
  10:    id         as order_id,
  11:    user_id    as customer_id,
  12:    order_date as order_date,
  13:    status     as status
  14:
  15:from 'dbt_tutorial'.jaffle_shop.orders
  16:  );
  17:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]
  compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
2021-10-18 02:35:53.922811 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9aace69-b89e-4254-b186-ef93edb5d87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23502f2c88>]}
2021-10-18 02:35:53.923732 (Thread-1): 22:35:53 | 1 of 2 ERROR creating table model dbt_jessie.stg_orders.............. [ERROR in 1.94s]
2021-10-18 02:35:53.924222 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 02:35:53.925471 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:35:53.926030 (Thread-1): 22:35:53 | 2 of 2 SKIP relation dbt_jessie.customers............................ [SKIP]
2021-10-18 02:35:53.926478 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:35:53.982404 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:35:53.983379 (MainThread): 22:35:53 | 
2021-10-18 02:35:53.983989 (MainThread): 22:35:53 | Finished running 2 table models in 2.92s.
2021-10-18 02:35:53.984581 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:35:53.984954 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 02:35:53.989422 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54712), raddr=('142.250.176.202', 443)>
2021-10-18 02:35:53.990088 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37670), raddr=('142.250.80.42', 443)>
2021-10-18 02:35:53.990631 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54716), raddr=('142.250.176.202', 443)>
2021-10-18 02:35:53.991087 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37674), raddr=('142.250.80.42', 443)>
2021-10-18 02:35:53.991612 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54720), raddr=('142.250.176.202', 443)>
2021-10-18 02:35:53.992045 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37678), raddr=('142.250.80.42', 443)>
2021-10-18 02:35:53.998630 (MainThread): 
2021-10-18 02:35:53.999375 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 02:35:54.000017 (MainThread): 
2021-10-18 02:35:54.000549 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-10-18 02:35:54.001036 (MainThread):   Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]
2021-10-18 02:35:54.001629 (MainThread):   compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
2021-10-18 02:35:54.002100 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-18 02:35:54.002643 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23503be908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23503bec18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235029f860>]}
2021-10-18 02:35:54.003272 (MainThread): Flushing usage events
2021-10-18 02:42:23.925326 (MainThread): Running with dbt=0.21.0
2021-10-18 02:42:24.218179 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:42:24.219178 (MainThread): Tracking: tracking
2021-10-18 02:42:24.220650 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e05ef62e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e05ef6208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e05ef6780>]}
2021-10-18 02:42:24.232791 (MainThread): Partial parsing not enabled
2021-10-18 02:42:24.239563 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:42:24.263060 (MainThread): Parsing macros/etc.sql
2021-10-18 02:42:24.265229 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:42:24.271116 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:42:24.282276 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:42:24.285293 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:42:24.287268 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:42:24.289991 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:42:24.304719 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:42:24.307592 (MainThread): Parsing macros/core.sql
2021-10-18 02:42:24.311334 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:42:24.321016 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:42:24.328253 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:42:24.350921 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:42:24.355641 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:42:24.362610 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:42:24.376836 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:42:24.378614 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:42:24.407903 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:42:24.425074 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:42:24.444523 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:42:24.446622 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:42:24.456873 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:42:24.464261 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:42:24.465523 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:42:24.469059 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:42:24.478268 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:42:24.480099 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:42:24.482119 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:42:24.483988 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:42:24.485747 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:42:24.536920 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:42:24.538584 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:42:24.539903 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:42:24.542208 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:42:24.739295 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:42:24.753532 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 02:42:24.756634 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:42:24.820518 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60a4c40d-2387-4e30-b776-a19e05a6747f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e0a34a588>]}
2021-10-18 02:42:24.824540 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60a4c40d-2387-4e30-b776-a19e05a6747f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e05f06668>]}
2021-10-18 02:42:24.824910 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:42:24.825839 (MainThread): 
2021-10-18 02:42:24.826305 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:42:24.827476 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:42:24.827749 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:42:25.404870 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:42:25.405714 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:42:25.417329 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:42:25.764554 (MainThread): 22:42:25 | Concurrency: 1 threads (target='dev')
2021-10-18 02:42:25.765242 (MainThread): 22:42:25 | 
2021-10-18 02:42:25.768464 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 02:42:25.769236 (Thread-1): 22:42:25 | 1 of 2 START table model dbt_jessie.stg_orders....................... [RUN]
2021-10-18 02:42:25.770104 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:42:25.770508 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 02:42:25.773303 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:42:25.774023 (Thread-1): finished collecting timing info
2021-10-18 02:42:25.847360 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:42:25.847874 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:42:25.852803 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id         as order_id,
    user_id    as customer_id,
    order_date as order_date,
    status     as status

from 'dbt_tutorial'.jaffle_shop.orders
  );
    
2021-10-18 02:42:26.323963 (Thread-1): Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]",)
2021-10-18 02:42:27.549660 (Thread-1): finished collecting timing info
2021-10-18 02:42:27.550743 (Thread-1): Database Error in model stg_orders (models/stg_orders.sql)
  Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]
  compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]

(job ID: b9a4bdc5-0060-4851-b9d7-fb5c944ea31c)

                                                         -----Query Job SQL Follows-----                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
   2:
   3:
   4:  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    select
  10:    id         as order_id,
  11:    user_id    as customer_id,
  12:    order_date as order_date,
  13:    status     as status
  14:
  15:from 'dbt_tutorial'.jaffle_shop.orders
  16:  );
  17:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]
  compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
2021-10-18 02:42:27.555788 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a4c40d-2387-4e30-b776-a19e05a6747f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e05e5e278>]}
2021-10-18 02:42:27.556801 (Thread-1): 22:42:27 | 1 of 2 ERROR creating table model dbt_jessie.stg_orders.............. [ERROR in 1.79s]
2021-10-18 02:42:27.557375 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 02:42:27.558769 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:42:27.559333 (Thread-1): 22:42:27 | 2 of 2 SKIP relation dbt_jessie.customers............................ [SKIP]
2021-10-18 02:42:27.559829 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:42:27.572957 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:42:27.574177 (MainThread): 22:42:27 | 
2021-10-18 02:42:27.574767 (MainThread): 22:42:27 | Finished running 2 table models in 2.75s.
2021-10-18 02:42:27.575301 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:42:27.575787 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 02:42:27.578756 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54812), raddr=('142.250.176.202', 443)>
2021-10-18 02:42:27.579418 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37770), raddr=('142.250.80.42', 443)>
2021-10-18 02:42:27.580096 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54816), raddr=('142.250.176.202', 443)>
2021-10-18 02:42:27.580694 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37774), raddr=('142.250.80.42', 443)>
2021-10-18 02:42:27.581330 (MainThread): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54824), raddr=('142.250.176.202', 443)>
2021-10-18 02:42:27.581745 (MainThread): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37782), raddr=('142.250.80.42', 443)>
2021-10-18 02:42:27.590573 (MainThread): 
2021-10-18 02:42:27.591237 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 02:42:27.591810 (MainThread): 
2021-10-18 02:42:27.592302 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-10-18 02:42:27.592736 (MainThread):   Syntax error: Unexpected string literal 'dbt_tutorial' at [15:6]
2021-10-18 02:42:27.593178 (MainThread):   compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
2021-10-18 02:42:27.593567 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-10-18 02:42:27.594250 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e0a34a588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e05e25fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e05e25438>]}
2021-10-18 02:42:27.594934 (MainThread): Flushing usage events
2021-10-18 02:42:55.675212 (MainThread): Running with dbt=0.21.0
2021-10-18 02:42:55.985493 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:42:55.986465 (MainThread): Tracking: tracking
2021-10-18 02:42:55.987671 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf870929b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8b5930f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8705a6d8>]}
2021-10-18 02:42:55.999364 (MainThread): Partial parsing not enabled
2021-10-18 02:42:56.006089 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:42:56.030581 (MainThread): Parsing macros/etc.sql
2021-10-18 02:42:56.032656 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:42:56.038322 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:42:56.050538 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:42:56.053545 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:42:56.055499 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:42:56.058256 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:42:56.073286 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:42:56.076415 (MainThread): Parsing macros/core.sql
2021-10-18 02:42:56.081550 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:42:56.091869 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:42:56.099450 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:42:56.124335 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:42:56.129179 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:42:56.136112 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:42:56.151183 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:42:56.153216 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:42:56.183993 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:42:56.201980 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:42:56.222614 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:42:56.224623 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:42:56.235473 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:42:56.243137 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:42:56.244727 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:42:56.247936 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:42:56.257092 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:42:56.258936 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:42:56.261498 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:42:56.263210 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:42:56.264848 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:42:56.318757 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:42:56.320633 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:42:56.322048 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:42:56.324361 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:42:56.536799 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:42:56.552098 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 02:42:56.555251 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:42:56.621012 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b724b69-af96-4cef-9597-9350643dc75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8a53dcf8>]}
2021-10-18 02:42:56.625231 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b724b69-af96-4cef-9597-9350643dc75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf870925f8>]}
2021-10-18 02:42:56.625630 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:42:56.626652 (MainThread): 
2021-10-18 02:42:56.627312 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:42:56.628618 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:42:56.628968 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:42:57.065720 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:42:57.066531 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:42:57.078938 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:42:57.558258 (MainThread): 22:42:57 | Concurrency: 1 threads (target='dev')
2021-10-18 02:42:57.558856 (MainThread): 22:42:57 | 
2021-10-18 02:42:57.562655 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 02:42:57.563529 (Thread-1): 22:42:57 | 1 of 3 START table model dbt_jessie.stg_customers.................... [RUN]
2021-10-18 02:42:57.564592 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 02:42:57.565260 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 02:42:57.568677 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 02:42:57.569542 (Thread-1): finished collecting timing info
2021-10-18 02:42:57.645178 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 02:42:57.645866 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:42:57.651626 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id          as customer_id,
    first_name  as first_name,
    last_name   as last_name

from 'dbt-tutorial'.jaffle_shop.customers
  );
    
2021-10-18 02:45:09.349185 (Thread-1): Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'dbt-tutorial' at [14:6]",)
2021-10-18 02:45:10.356995 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54832), raddr=('142.250.176.202', 443)>
2021-10-18 02:45:10.357706 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37790), raddr=('142.250.80.42', 443)>
2021-10-18 02:45:10.358341 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54836), raddr=('142.250.176.202', 443)>
2021-10-18 02:45:10.358861 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37794), raddr=('142.250.80.42', 443)>
2021-10-18 02:45:10.546799 (Thread-1): finished collecting timing info
2021-10-18 02:45:10.547878 (Thread-1): Database Error in model stg_customers (models/stg_customers.sql)
  Syntax error: Unexpected string literal 'dbt-tutorial' at [14:6]
  compiled SQL at target/run/jaffle_shop/models/stg_customers.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected string literal 'dbt-tutorial' at [14:6]

(job ID: da34f2e9-2c4a-49e5-bfc3-3d81bcf40991)

                                                           -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
   2:
   3:
   4:  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    select
  10:    id          as customer_id,
  11:    first_name  as first_name,
  12:    last_name   as last_name
  13:
  14:from 'dbt-tutorial'.jaffle_shop.customers
  15:  );
  16:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/stg_customers.sql)
  Syntax error: Unexpected string literal 'dbt-tutorial' at [14:6]
  compiled SQL at target/run/jaffle_shop/models/stg_customers.sql
2021-10-18 02:45:10.553125 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b724b69-af96-4cef-9597-9350643dc75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf87049940>]}
2021-10-18 02:45:10.554155 (Thread-1): 22:45:10 | 1 of 3 ERROR creating table model dbt_jessie.stg_customers........... [ERROR in 132.99s]
2021-10-18 02:45:10.554702 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 02:45:10.555261 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 02:45:10.556428 (Thread-1): 22:45:10 | 2 of 3 START table model dbt_jessie.stg_orders....................... [RUN]
2021-10-18 02:45:10.557383 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:45:10.557859 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 02:45:10.561377 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:45:10.562172 (Thread-1): finished collecting timing info
2021-10-18 02:45:10.567196 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:45:10.568408 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:45:10.582746 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id         as order_id,
    user_id    as customer_id,
    order_date as order_date,
    status     as status

from 'dbt-tutorial'.jaffle_shop.orders
  );
    
2021-10-18 02:45:10.987892 (Thread-1): Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]",)
2021-10-18 02:45:12.170696 (Thread-1): finished collecting timing info
2021-10-18 02:45:12.171880 (Thread-1): Database Error in model stg_orders (models/stg_orders.sql)
  Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]
  compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]

(job ID: 621fdeca-d3be-4bfa-919a-aca2259a61a4)

                                                         -----Query Job SQL Follows-----                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
   2:
   3:
   4:  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    select
  10:    id         as order_id,
  11:    user_id    as customer_id,
  12:    order_date as order_date,
  13:    status     as status
  14:
  15:from 'dbt-tutorial'.jaffle_shop.orders
  16:  );
  17:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]
  compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
2021-10-18 02:45:12.173348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b724b69-af96-4cef-9597-9350643dc75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf86fd7d68>]}
2021-10-18 02:45:12.174272 (Thread-1): 22:45:12 | 2 of 3 ERROR creating table model dbt_jessie.stg_orders.............. [ERROR in 1.62s]
2021-10-18 02:45:12.174844 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 02:45:12.176178 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:45:12.176938 (Thread-1): 22:45:12 | 3 of 3 SKIP relation dbt_jessie.customers............................ [SKIP]
2021-10-18 02:45:12.177492 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:45:12.195874 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:45:12.197136 (MainThread): 22:45:12 | 
2021-10-18 02:45:12.197681 (MainThread): 22:45:12 | Finished running 3 table models in 135.57s.
2021-10-18 02:45:12.198109 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:45:12.198523 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 02:45:12.208303 (MainThread): 
2021-10-18 02:45:12.208988 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-18 02:45:12.209669 (MainThread): 
2021-10-18 02:45:12.210185 (MainThread): Database Error in model stg_customers (models/stg_customers.sql)
2021-10-18 02:45:12.210592 (MainThread):   Syntax error: Unexpected string literal 'dbt-tutorial' at [14:6]
2021-10-18 02:45:12.210987 (MainThread):   compiled SQL at target/run/jaffle_shop/models/stg_customers.sql
2021-10-18 02:45:12.211360 (MainThread): 
2021-10-18 02:45:12.211780 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-10-18 02:45:12.212276 (MainThread):   Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]
2021-10-18 02:45:12.212687 (MainThread):   compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
2021-10-18 02:45:12.213212 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-10-18 02:45:12.213803 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf8705a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf86f5a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf86fc40b8>]}
2021-10-18 02:45:12.214501 (MainThread): Flushing usage events
2021-10-18 02:45:58.833329 (MainThread): Running with dbt=0.21.0
2021-10-18 02:45:59.143765 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:45:59.144622 (MainThread): Tracking: tracking
2021-10-18 02:45:59.145624 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f31b3208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f31b34a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f31b3470>]}
2021-10-18 02:45:59.157877 (MainThread): Partial parsing not enabled
2021-10-18 02:45:59.164520 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:45:59.189299 (MainThread): Parsing macros/etc.sql
2021-10-18 02:45:59.191741 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:45:59.197662 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:45:59.208141 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:45:59.211435 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:45:59.213545 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:45:59.216664 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:45:59.235510 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:45:59.238352 (MainThread): Parsing macros/core.sql
2021-10-18 02:45:59.242997 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:45:59.253956 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:45:59.261142 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:45:59.284551 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:45:59.288696 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:45:59.296076 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:45:59.311987 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:45:59.313946 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:45:59.345458 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:45:59.364027 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:45:59.385409 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:45:59.387393 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:45:59.397858 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:45:59.405131 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:45:59.406805 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:45:59.410251 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:45:59.419459 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:45:59.421256 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:45:59.424078 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:45:59.425810 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:45:59.427423 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:45:59.483546 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:45:59.485312 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:45:59.486617 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:45:59.488886 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:45:59.699212 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:45:59.714488 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 02:45:59.717928 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:45:59.784364 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b783505-2f2e-4cab-ba1d-c2154649c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fa51d4a8>]}
2021-10-18 02:45:59.788605 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b783505-2f2e-4cab-ba1d-c2154649c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f31dafd0>]}
2021-10-18 02:45:59.789026 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:45:59.790248 (MainThread): 
2021-10-18 02:45:59.790771 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:45:59.791954 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:45:59.792332 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:46:00.244784 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:46:00.245551 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:46:00.257369 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:46:00.653523 (MainThread): 22:46:00 | Concurrency: 1 threads (target='dev')
2021-10-18 02:46:00.654119 (MainThread): 22:46:00 | 
2021-10-18 02:46:00.657710 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 02:46:00.658636 (Thread-1): 22:46:00 | 1 of 3 START table model dbt_jessie.stg_customers.................... [RUN]
2021-10-18 02:46:00.659601 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 02:46:00.660049 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 02:46:00.663208 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 02:46:00.663992 (Thread-1): finished collecting timing info
2021-10-18 02:46:00.738811 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 02:46:00.739330 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:46:00.744453 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id          as customer_id,
    first_name  as first_name,
    last_name   as last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-10-18 02:46:03.635065 (Thread-1): finished collecting timing info
2021-10-18 02:46:03.636181 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b783505-2f2e-4cab-ba1d-c2154649c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f30db978>]}
2021-10-18 02:46:03.637180 (Thread-1): 22:46:03 | 1 of 3 OK created table model dbt_jessie.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 2.98s]
2021-10-18 02:46:03.637740 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 02:46:03.638339 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 02:46:03.639155 (Thread-1): 22:46:03 | 2 of 3 START table model dbt_jessie.stg_orders....................... [RUN]
2021-10-18 02:46:03.639955 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:46:03.640526 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 02:46:03.643854 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:46:03.644742 (Thread-1): finished collecting timing info
2021-10-18 02:46:03.647157 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54906), raddr=('142.250.176.202', 443)>
2021-10-18 02:46:03.647778 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37864), raddr=('142.250.80.42', 443)>
2021-10-18 02:46:03.648320 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54910), raddr=('142.250.176.202', 443)>
2021-10-18 02:46:03.648773 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37868), raddr=('142.250.80.42', 443)>
2021-10-18 02:46:03.649383 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54914), raddr=('142.250.176.202', 443)>
2021-10-18 02:46:03.649831 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37872), raddr=('142.250.80.42', 443)>
2021-10-18 02:46:03.654426 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:46:03.655427 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:46:03.667149 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id         as order_id,
    user_id    as customer_id,
    order_date as order_date,
    status     as status

from 'dbt-tutorial'.jaffle_shop.orders
  );
    
2021-10-18 02:46:04.134244 (Thread-1): Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]",)
2021-10-18 02:46:05.363803 (Thread-1): finished collecting timing info
2021-10-18 02:46:05.365553 (Thread-1): Database Error in model stg_orders (models/stg_orders.sql)
  Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]
  compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 163, in exception_handler
    yield
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 345, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 552, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1372, in result
    do_get_result()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 291, in retry_wrapped_func
    on_error=on_error,
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/retry.py", line 189, in retry_target
    return target()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/query.py", line 1362, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/cloud/bigquery/job/base.py", line 713, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/google/api_core/future/polling.py", line 135, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]

(job ID: 851ef32d-03aa-46bc-8463-9f626f02f8b2)

                                                         -----Query Job SQL Follows-----                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
   2:
   3:
   4:  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    select
  10:    id         as order_id,
  11:    user_id    as customer_id,
  12:    order_date as order_date,
  13:    status     as status
  14:
  15:from 'dbt-tutorial'.jaffle_shop.orders
  16:  );
  17:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 229, in execute
    fetch=fetch
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 356, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 347, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 571, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 167, in exception_handler
    self.handle_error(e, message)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/adapters/bigquery/connections.py", line 155, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/stg_orders.sql)
  Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]
  compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
2021-10-18 02:46:05.371196 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b783505-2f2e-4cab-ba1d-c2154649c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f07ab978>]}
2021-10-18 02:46:05.372296 (Thread-1): 22:46:05 | 2 of 3 ERROR creating table model dbt_jessie.stg_orders.............. [ERROR in 1.73s]
2021-10-18 02:46:05.372867 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 02:46:05.374210 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:46:05.374821 (Thread-1): 22:46:05 | 3 of 3 SKIP relation dbt_jessie.customers............................ [SKIP]
2021-10-18 02:46:05.375310 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:46:05.469290 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:46:05.470501 (MainThread): 22:46:05 | 
2021-10-18 02:46:05.471061 (MainThread): 22:46:05 | Finished running 3 table models in 5.68s.
2021-10-18 02:46:05.471618 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:46:05.472047 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 02:46:05.482984 (MainThread): 
2021-10-18 02:46:05.483547 (MainThread): Completed with 1 error and 0 warnings:
2021-10-18 02:46:05.484111 (MainThread): 
2021-10-18 02:46:05.484835 (MainThread): Database Error in model stg_orders (models/stg_orders.sql)
2021-10-18 02:46:05.485539 (MainThread):   Syntax error: Unexpected string literal 'dbt-tutorial' at [15:6]
2021-10-18 02:46:05.486267 (MainThread):   compiled SQL at target/run/jaffle_shop/models/stg_orders.sql
2021-10-18 02:46:05.487019 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-10-18 02:46:05.488010 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f84c3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f07afda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31f30e3fd0>]}
2021-10-18 02:46:05.489071 (MainThread): Flushing usage events
2021-10-18 02:46:43.263730 (MainThread): Running with dbt=0.21.0
2021-10-18 02:46:43.573880 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 02:46:43.575035 (MainThread): Tracking: tracking
2021-10-18 02:46:43.576128 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dab497208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dab4974a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dab497470>]}
2021-10-18 02:46:43.587466 (MainThread): Partial parsing not enabled
2021-10-18 02:46:43.594937 (MainThread): Parsing macros/adapters.sql
2021-10-18 02:46:43.619801 (MainThread): Parsing macros/etc.sql
2021-10-18 02:46:43.621916 (MainThread): Parsing macros/catalog.sql
2021-10-18 02:46:43.628264 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 02:46:43.638821 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 02:46:43.642123 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 02:46:43.644040 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 02:46:43.646773 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 02:46:43.663459 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 02:46:43.666572 (MainThread): Parsing macros/core.sql
2021-10-18 02:46:43.670566 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 02:46:43.681124 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 02:46:43.687984 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 02:46:43.714036 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 02:46:43.718314 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 02:46:43.727663 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 02:46:43.742008 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 02:46:43.744123 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 02:46:43.774781 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 02:46:43.792718 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 02:46:43.813017 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 02:46:43.814971 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 02:46:43.825105 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 02:46:43.833336 (MainThread): Parsing macros/etc/query.sql
2021-10-18 02:46:43.834771 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 02:46:43.837835 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 02:46:43.847603 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 02:46:43.849430 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 02:46:43.851249 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 02:46:43.852766 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 02:46:43.854364 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 02:46:43.907074 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 02:46:43.909235 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 02:46:43.910596 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 02:46:43.912891 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 02:46:44.121875 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:46:44.137083 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 02:46:44.140238 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:46:44.205566 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c97331f-d0bc-40d5-aca0-d9aa0f42211d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dadd4fef0>]}
2021-10-18 02:46:44.210756 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c97331f-d0bc-40d5-aca0-d9aa0f42211d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dab4bd860>]}
2021-10-18 02:46:44.211147 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 02:46:44.212091 (MainThread): 
2021-10-18 02:46:44.212553 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:46:44.213662 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 02:46:44.213981 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 02:46:44.687230 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 02:46:44.687997 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 02:46:44.699556 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:46:45.097338 (MainThread): 22:46:45 | Concurrency: 1 threads (target='dev')
2021-10-18 02:46:45.098002 (MainThread): 22:46:45 | 
2021-10-18 02:46:45.101519 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 02:46:45.102395 (Thread-1): 22:46:45 | 1 of 3 START table model dbt_jessie.stg_customers.................... [RUN]
2021-10-18 02:46:45.103377 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 02:46:45.103874 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 02:46:45.107047 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 02:46:45.107797 (Thread-1): finished collecting timing info
2021-10-18 02:46:45.154608 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:46:45.163975 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:46:45.751790 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 02:46:45.752681 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id          as customer_id,
    first_name  as first_name,
    last_name   as last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-10-18 02:46:48.177583 (Thread-1): finished collecting timing info
2021-10-18 02:46:48.179005 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c97331f-d0bc-40d5-aca0-d9aa0f42211d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dab348dd8>]}
2021-10-18 02:46:48.180090 (Thread-1): 22:46:48 | 1 of 3 OK created table model dbt_jessie.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 3.08s]
2021-10-18 02:46:48.180719 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 02:46:48.181490 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 02:46:48.182631 (Thread-1): 22:46:48 | 2 of 3 START table model dbt_jessie.stg_orders....................... [RUN]
2021-10-18 02:46:48.183835 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 02:46:48.184477 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 02:46:48.187464 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:46:48.188299 (Thread-1): finished collecting timing info
2021-10-18 02:46:48.190578 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54940), raddr=('142.250.176.202', 443)>
2021-10-18 02:46:48.191185 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37898), raddr=('142.250.80.42', 443)>
2021-10-18 02:46:48.191689 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54944), raddr=('142.250.176.202', 443)>
2021-10-18 02:46:48.192262 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37902), raddr=('142.250.80.42', 443)>
2021-10-18 02:46:48.192863 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54948), raddr=('142.250.176.202', 443)>
2021-10-18 02:46:48.193314 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37906), raddr=('142.250.80.42', 443)>
2021-10-18 02:46:48.200728 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 02:46:48.202068 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:46:48.214961 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id         as order_id,
    user_id    as customer_id,
    order_date as order_date,
    status     as status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2021-10-18 02:46:50.728030 (Thread-1): finished collecting timing info
2021-10-18 02:46:50.729300 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c97331f-d0bc-40d5-aca0-d9aa0f42211d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da8a92080>]}
2021-10-18 02:46:50.730397 (Thread-1): 22:46:50 | 2 of 3 OK created table model dbt_jessie.stg_orders.................. [CREATE TABLE (99.0 rows, 3.3 KB processed) in 2.55s]
2021-10-18 02:46:50.731308 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 02:46:50.732484 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 02:46:50.733288 (Thread-1): 22:46:50 | 3 of 3 START table model dbt_jessie.customers........................ [RUN]
2021-10-18 02:46:50.734221 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 02:46:50.734696 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 02:46:50.736685 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 54952), raddr=('142.250.176.202', 443)>
2021-10-18 02:46:50.737316 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 37910), raddr=('142.250.80.42', 443)>
2021-10-18 02:46:50.742351 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 02:46:50.743217 (Thread-1): finished collecting timing info
2021-10-18 02:46:50.747393 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 02:46:50.761310 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:46:51.238944 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 02:46:51.444973 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-10-18 02:46:51.446006 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `dbttutorial2021`.`dbt_jessie`.`stg_customers`

),

orders as (

    select * from `dbttutorial2021`.`dbt_jessie`.`stg_orders`

),

customer_orders as (

    select
        customer_id     as customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-10-18 02:46:54.311901 (Thread-1): finished collecting timing info
2021-10-18 02:46:54.312481 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c97331f-d0bc-40d5-aca0-d9aa0f42211d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da8abf860>]}
2021-10-18 02:46:54.312993 (Thread-1): 22:46:54 | 3 of 3 OK created table model dbt_jessie.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.58s]
2021-10-18 02:46:54.313281 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 02:46:54.322398 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 02:46:54.322977 (MainThread): 22:46:54 | 
2021-10-18 02:46:54.323225 (MainThread): 22:46:54 | Finished running 3 table models in 10.11s.
2021-10-18 02:46:54.323420 (MainThread): Connection 'master' was properly closed.
2021-10-18 02:46:54.323624 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-10-18 02:46:54.330069 (MainThread): 
2021-10-18 02:46:54.330421 (MainThread): Completed successfully
2021-10-18 02:46:54.330701 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-18 02:46:54.331021 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db07a6b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da8aa5b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da8a8eeb8>]}
2021-10-18 02:46:54.331432 (MainThread): Flushing usage events
2021-10-18 17:33:41.245203 (MainThread): Running with dbt=0.21.0
2021-10-18 17:33:41.802365 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['staging/stg_customers.sql'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 17:33:41.804269 (MainThread): Tracking: tracking
2021-10-18 17:33:41.805869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeca432128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbecccfdf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbecccfd748>]}
2021-10-18 17:33:41.824329 (MainThread): Partial parsing not enabled
2021-10-18 17:33:41.840391 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:33:41.880864 (MainThread): Parsing macros/etc.sql
2021-10-18 17:33:41.885281 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:33:41.900519 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:33:41.920022 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:33:41.924490 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:33:41.927647 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:33:41.932601 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:33:41.956491 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:33:41.961123 (MainThread): Parsing macros/core.sql
2021-10-18 17:33:41.967228 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:33:41.983254 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:33:41.995757 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:33:42.030903 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:33:42.038279 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:33:42.049707 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:33:42.071596 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:33:42.074399 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:33:42.128216 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:33:42.156235 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:33:42.187575 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:33:42.190963 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:33:42.206963 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:33:42.218648 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:33:42.220479 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:33:42.225006 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:33:42.237970 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:33:42.243005 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:33:42.246915 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:33:42.249717 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:33:42.252205 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:33:42.333232 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:33:42.335801 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:33:42.337848 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:33:42.341708 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:33:42.676507 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:33:42.697906 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:33:42.703130 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:33:42.792418 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c9cbb88-7982-4059-9517-534413242185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeceada080>]}
2021-10-18 17:33:42.799181 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c9cbb88-7982-4059-9517-534413242185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeca432630>]}
2021-10-18 17:33:42.800061 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:33:42.801845 (MainThread): The selection criterion 'staging/stg_customers.sql' does not match any nodes
2021-10-18 17:33:42.802581 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-18 17:33:42.808381 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeca469ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeca469b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeca4698d0>]}
2021-10-18 17:33:42.809454 (MainThread): Flushing usage events
2021-10-18 17:33:43.052205 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 17:33:51.806672 (MainThread): Running with dbt=0.21.0
2021-10-18 17:33:52.191218 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['stg_customers.sql'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 17:33:52.192230 (MainThread): Tracking: tracking
2021-10-18 17:33:52.193693 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6308f6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa634df40b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6308f64a8>]}
2021-10-18 17:33:52.210530 (MainThread): Partial parsing not enabled
2021-10-18 17:33:52.221023 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:33:52.256379 (MainThread): Parsing macros/etc.sql
2021-10-18 17:33:52.259397 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:33:52.266625 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:33:52.280432 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:33:52.284179 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:33:52.286931 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:33:52.291178 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:33:52.311321 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:33:52.315263 (MainThread): Parsing macros/core.sql
2021-10-18 17:33:52.323430 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:33:52.338743 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:33:52.348059 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:33:52.378672 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:33:52.383617 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:33:52.393047 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:33:52.410915 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:33:52.413505 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:33:52.452322 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:33:52.475864 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:33:52.499373 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:33:52.502338 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:33:52.516846 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:33:52.527319 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:33:52.528885 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:33:52.532485 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:33:52.543884 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:33:52.546207 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:33:52.548721 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:33:52.550887 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:33:52.553674 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:33:52.621310 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:33:52.623804 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:33:52.625932 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:33:52.629121 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:33:52.883148 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:33:52.900607 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:33:52.904495 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:33:52.983509 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '648934ce-5f9a-43b8-b2bf-f2aa85f4d76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa634157b38>]}
2021-10-18 17:33:52.992143 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '648934ce-5f9a-43b8-b2bf-f2aa85f4d76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6308ea080>]}
2021-10-18 17:33:52.992838 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:33:52.993982 (MainThread): The selection criterion 'stg_customers.sql' does not match any nodes
2021-10-18 17:33:52.994787 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-18 17:33:53.001007 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa634df3cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6345b8d68>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6308f66d8>]}
2021-10-18 17:33:53.001574 (MainThread): Flushing usage events
2021-10-18 17:33:53.168030 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 17:34:03.430671 (MainThread): Running with dbt=0.21.0
2021-10-18 17:34:03.806871 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['models/staging/stg_customers.sql'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 17:34:03.807910 (MainThread): Tracking: tracking
2021-10-18 17:34:03.809958 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ba04b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bc8deef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bc8de6a0>]}
2021-10-18 17:34:03.826629 (MainThread): Partial parsing not enabled
2021-10-18 17:34:03.837589 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:34:03.874999 (MainThread): Parsing macros/etc.sql
2021-10-18 17:34:03.878148 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:34:03.886422 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:34:03.900485 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:34:03.904191 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:34:03.906856 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:34:03.911087 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:34:03.931681 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:34:03.935918 (MainThread): Parsing macros/core.sql
2021-10-18 17:34:03.940755 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:34:03.954285 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:34:03.963181 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:34:03.998309 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:34:04.006952 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:34:04.017213 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:34:04.036115 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:34:04.038606 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:34:04.079631 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:34:04.102615 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:34:04.127986 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:34:04.130635 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:34:04.144442 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:34:04.154668 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:34:04.156247 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:34:04.160064 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:34:04.171465 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:34:04.174060 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:34:04.176529 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:34:04.178799 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:34:04.181066 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:34:04.247509 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:34:04.250485 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:34:04.252389 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:34:04.255868 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:34:04.506417 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:34:04.524327 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:34:04.528405 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:34:04.605903 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e81f5130-b96a-4c07-a6c5-4645d53c56e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00c138e4a8>]}
2021-10-18 17:34:04.613014 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e81f5130-b96a-4c07-a6c5-4645d53c56e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ba0469e8>]}
2021-10-18 17:34:04.613578 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:34:04.615250 (MainThread): 
2021-10-18 17:34:04.615886 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:34:04.617600 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 17:34:04.618050 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 17:34:06.027114 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 17:34:06.027488 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 17:34:06.035309 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:34:07.887844 (MainThread): 13:34:07 | Concurrency: 1 threads (target='dev')
2021-10-18 17:34:07.888255 (MainThread): 13:34:07 | 
2021-10-18 17:34:07.891434 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 17:34:07.892142 (Thread-1): 13:34:07 | 1 of 1 START table model dbt_jessie.stg_customers.................... [RUN]
2021-10-18 17:34:07.893154 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:34:07.893822 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 17:34:07.895867 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:34:07.896342 (Thread-1): finished collecting timing info
2021-10-18 17:34:07.947906 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:34:07.958179 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:34:08.735040 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:34:08.736022 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id          as customer_id,
    first_name  as first_name,
    last_name   as last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-10-18 17:34:12.173148 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 38856), raddr=('142.250.65.234', 443)>
2021-10-18 17:34:12.173910 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 35938), raddr=('142.250.80.10', 443)>
2021-10-18 17:34:12.174660 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 38860), raddr=('142.250.65.234', 443)>
2021-10-18 17:34:12.175156 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 35942), raddr=('142.250.80.10', 443)>
2021-10-18 17:34:12.185645 (Thread-1): finished collecting timing info
2021-10-18 17:34:12.186744 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81f5130-b96a-4c07-a6c5-4645d53c56e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b9f699b0>]}
2021-10-18 17:34:12.187687 (Thread-1): 13:34:12 | 1 of 1 OK created table model dbt_jessie.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 4.29s]
2021-10-18 17:34:12.188184 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 17:34:12.209061 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:34:12.210036 (MainThread): 13:34:12 | 
2021-10-18 17:34:12.210533 (MainThread): 13:34:12 | Finished running 1 table model in 7.59s.
2021-10-18 17:34:12.210966 (MainThread): Connection 'master' was properly closed.
2021-10-18 17:34:12.211497 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-10-18 17:34:12.222463 (MainThread): 
2021-10-18 17:34:12.223469 (MainThread): Completed successfully
2021-10-18 17:34:12.224260 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-18 17:34:12.224934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00b9f87c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00bd5807b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ba0258d0>]}
2021-10-18 17:34:12.225546 (MainThread): Flushing usage events
2021-10-18 17:34:32.337250 (MainThread): Running with dbt=0.21.0
2021-10-18 17:34:32.705127 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=['models/customers.sql'], fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 17:34:32.706456 (MainThread): Tracking: tracking
2021-10-18 17:34:32.708091 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2dc85ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3054cf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3054c710>]}
2021-10-18 17:34:32.724816 (MainThread): Partial parsing not enabled
2021-10-18 17:34:32.735066 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:34:32.770686 (MainThread): Parsing macros/etc.sql
2021-10-18 17:34:32.773802 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:34:32.781030 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:34:32.795606 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:34:32.799374 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:34:32.801921 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:34:32.805817 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:34:32.825717 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:34:32.829727 (MainThread): Parsing macros/core.sql
2021-10-18 17:34:32.834955 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:34:32.847681 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:34:32.858536 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:34:32.892080 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:34:32.897232 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:34:32.907250 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:34:32.925068 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:34:32.927773 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:34:32.967158 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:34:32.992424 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:34:33.017695 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:34:33.021233 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:34:33.036428 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:34:33.046991 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:34:33.048663 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:34:33.052431 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:34:33.064106 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:34:33.066430 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:34:33.069205 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:34:33.072167 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:34:33.074957 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:34:33.142584 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:34:33.144686 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:34:33.146502 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:34:33.149747 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:34:33.403260 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:34:33.420490 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:34:33.424838 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:34:33.503806 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '889c3f26-8c9d-41f0-8a10-b137cf7c9cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d33f6fd68>]}
2021-10-18 17:34:33.510077 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '889c3f26-8c9d-41f0-8a10-b137cf7c9cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2dc85550>]}
2021-10-18 17:34:33.510652 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:34:33.512504 (MainThread): 
2021-10-18 17:34:33.513075 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:34:33.514988 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 17:34:33.515371 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 17:34:33.973707 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 17:34:33.974510 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 17:34:33.987586 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:34:34.486251 (MainThread): 13:34:34 | Concurrency: 1 threads (target='dev')
2021-10-18 17:34:34.486860 (MainThread): 13:34:34 | 
2021-10-18 17:34:34.490596 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 17:34:34.491475 (Thread-1): 13:34:34 | 1 of 2 START table model dbt_jessie.stg_customers.................... [RUN]
2021-10-18 17:34:34.492900 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:34:34.493415 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 17:34:34.496531 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:34:34.497407 (Thread-1): finished collecting timing info
2021-10-18 17:34:34.542857 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:34:34.553627 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:34:35.039944 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:34:35.041020 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id          as customer_id,
    first_name  as first_name,
    last_name   as last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2021-10-18 17:34:37.864432 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 38874), raddr=('142.250.65.234', 443)>
2021-10-18 17:34:37.865172 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 35956), raddr=('142.250.80.10', 443)>
2021-10-18 17:34:37.866108 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 38878), raddr=('142.250.65.234', 443)>
2021-10-18 17:34:37.866937 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 35960), raddr=('142.250.80.10', 443)>
2021-10-18 17:34:37.878235 (Thread-1): finished collecting timing info
2021-10-18 17:34:37.879601 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '889c3f26-8c9d-41f0-8a10-b137cf7c9cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2dbdbf28>]}
2021-10-18 17:34:37.880650 (Thread-1): 13:34:37 | 1 of 2 OK created table model dbt_jessie.stg_customers............... [CREATE TABLE (100.0 rows, 1.9 KB processed) in 3.39s]
2021-10-18 17:34:37.881224 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 17:34:37.881929 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 17:34:37.882803 (Thread-1): 13:34:37 | 2 of 2 START table model dbt_jessie.stg_orders....................... [RUN]
2021-10-18 17:34:37.884113 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:34:37.884609 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 17:34:37.888019 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 17:34:37.888863 (Thread-1): finished collecting timing info
2021-10-18 17:34:37.893197 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:34:37.905503 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:34:38.375069 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 17:34:38.375964 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id         as order_id,
    user_id    as customer_id,
    order_date as order_date,
    status     as status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2021-10-18 17:34:40.990672 (Thread-1): finished collecting timing info
2021-10-18 17:34:40.991871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '889c3f26-8c9d-41f0-8a10-b137cf7c9cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2dbfacc0>]}
2021-10-18 17:34:40.992868 (Thread-1): 13:34:40 | 2 of 2 OK created table model dbt_jessie.stg_orders.................. [CREATE TABLE (99.0 rows, 3.3 KB processed) in 3.11s]
2021-10-18 17:34:40.993457 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 17:34:41.016458 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:34:41.017442 (MainThread): 13:34:41 | 
2021-10-18 17:34:41.017926 (MainThread): 13:34:41 | Finished running 2 table models in 7.50s.
2021-10-18 17:34:41.018320 (MainThread): Connection 'master' was properly closed.
2021-10-18 17:34:41.018645 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 17:34:41.027784 (MainThread): 
2021-10-18 17:34:41.028580 (MainThread): Completed successfully
2021-10-18 17:34:41.029486 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-18 17:34:41.030156 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2dbf1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2dc9a908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d2db570f0>]}
2021-10-18 17:34:41.030889 (MainThread): Flushing usage events
2021-10-18 17:37:38.041942 (MainThread): Running with dbt=0.21.0
2021-10-18 17:37:38.421836 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 17:37:38.422960 (MainThread): Tracking: tracking
2021-10-18 17:37:38.424559 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc13c5f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc13c5f4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc13c5f4a8>]}
2021-10-18 17:37:38.441875 (MainThread): Partial parsing not enabled
2021-10-18 17:37:38.452444 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:37:38.487516 (MainThread): Parsing macros/etc.sql
2021-10-18 17:37:38.490550 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:37:38.497911 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:37:38.511801 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:37:38.515710 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:37:38.518442 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:37:38.522887 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:37:38.549663 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:37:38.553676 (MainThread): Parsing macros/core.sql
2021-10-18 17:37:38.559426 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:37:38.572153 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:37:38.581064 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:37:38.611105 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:37:38.616984 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:37:38.626684 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:37:38.644571 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:37:38.647318 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:37:38.687260 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:37:38.711081 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:37:38.737080 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:37:38.741030 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:37:38.755376 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:37:38.764864 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:37:38.766767 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:37:38.770722 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:37:38.782993 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:37:38.785340 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:37:38.787973 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:37:38.791158 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:37:38.793971 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:37:38.862319 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:37:38.864582 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:37:38.866630 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:37:38.870305 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:37:39.167452 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:37:39.184850 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:37:39.189552 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:37:39.265219 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17dbb91a-0700-44cb-9557-af3e3cc4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1afcb4a8>]}
2021-10-18 17:37:39.271386 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17dbb91a-0700-44cb-9557-af3e3cc4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc13c83860>]}
2021-10-18 17:37:39.272146 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:37:39.273748 (MainThread): 
2021-10-18 17:37:39.274325 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:37:39.276128 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 17:37:39.276647 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 17:37:39.730950 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 17:37:39.731744 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 17:37:39.744318 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:37:40.242517 (MainThread): 13:37:40 | Concurrency: 1 threads (target='dev')
2021-10-18 17:37:40.243144 (MainThread): 13:37:40 | 
2021-10-18 17:37:40.246844 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 17:37:40.247669 (Thread-1): 13:37:40 | 1 of 3 START view model dbt_jessie.stg_customers..................... [RUN]
2021-10-18 17:37:40.248588 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:37:40.249132 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 17:37:40.252544 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:37:40.253404 (Thread-1): finished collecting timing info
2021-10-18 17:37:40.303257 (Thread-1): finished collecting timing info
2021-10-18 17:37:40.304169 (Thread-1): Compilation Error in model stg_customers (models/staging/stg_customers.sql)
  Trying to create view `dbttutorial2021`.`dbt_jessie`.`stg_customers`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model stg_customers (models/staging/stg_customers.sql)
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 1017, in inner
    raise exc
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 1014, in inner
    return func(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 686, in relation_wrong_type
    model)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_customers (models/staging/stg_customers.sql)
  Trying to create view `dbttutorial2021`.`dbt_jessie`.`stg_customers`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model stg_customers (models/staging/stg_customers.sql)
2021-10-18 17:37:40.308438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17dbb91a-0700-44cb-9557-af3e3cc4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc13b3a4e0>]}
2021-10-18 17:37:40.309261 (Thread-1): 13:37:40 | 1 of 3 ERROR creating view model dbt_jessie.stg_customers............ [ERROR in 0.06s]
2021-10-18 17:37:40.309675 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 17:37:40.310108 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 17:37:40.310638 (Thread-1): 13:37:40 | 2 of 3 START view model dbt_jessie.stg_orders........................ [RUN]
2021-10-18 17:37:40.311263 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:37:40.311606 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 17:37:40.314040 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 17:37:40.315036 (Thread-1): finished collecting timing info
2021-10-18 17:37:40.318351 (Thread-1): finished collecting timing info
2021-10-18 17:37:40.318951 (Thread-1): Compilation Error in model stg_orders (models/staging/stg_orders.sql)
  Trying to create view `dbttutorial2021`.`dbt_jessie`.`stg_orders`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model stg_orders (models/staging/stg_orders.sql)
Traceback (most recent call last):
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 40, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 1017, in inner
    raise exc
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 1014, in inner
    return func(*args, **kwargs)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 686, in relation_wrong_type
    model)
  File "/home/jessie/repos/dbt_projects/.venv/lib/python3.6/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orders (models/staging/stg_orders.sql)
  Trying to create view `dbttutorial2021`.`dbt_jessie`.`stg_orders`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model stg_orders (models/staging/stg_orders.sql)
2021-10-18 17:37:40.319820 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17dbb91a-0700-44cb-9557-af3e3cc4ef75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc13b556a0>]}
2021-10-18 17:37:40.320357 (Thread-1): 13:37:40 | 2 of 3 ERROR creating view model dbt_jessie.stg_orders............... [ERROR in 0.01s]
2021-10-18 17:37:40.320732 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 17:37:40.321634 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 17:37:40.322096 (Thread-1): 13:37:40 | 3 of 3 SKIP relation dbt_jessie.customers............................ [SKIP]
2021-10-18 17:37:40.322759 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 17:37:40.346804 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:37:40.347692 (MainThread): 13:37:40 | 
2021-10-18 17:37:40.348129 (MainThread): 13:37:40 | Finished running 2 view models, 1 table model in 1.07s.
2021-10-18 17:37:40.348502 (MainThread): Connection 'master' was properly closed.
2021-10-18 17:37:40.348821 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 17:37:40.352283 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 38948), raddr=('142.250.65.234', 443)>
2021-10-18 17:37:40.352869 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36030), raddr=('142.250.80.10', 443)>
2021-10-18 17:37:40.353500 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 38952), raddr=('142.250.65.234', 443)>
2021-10-18 17:37:40.353926 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36034), raddr=('142.250.80.10', 443)>
2021-10-18 17:37:40.360430 (MainThread): 
2021-10-18 17:37:40.360948 (MainThread): Completed with 2 errors and 0 warnings:
2021-10-18 17:37:40.361342 (MainThread): 
2021-10-18 17:37:40.361714 (MainThread): Compilation Error in model stg_customers (models/staging/stg_customers.sql)
2021-10-18 17:37:40.362057 (MainThread):   Trying to create view `dbttutorial2021`.`dbt_jessie`.`stg_customers`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-10-18 17:37:40.362377 (MainThread):   
2021-10-18 17:37:40.362690 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2021-10-18 17:37:40.362998 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2021-10-18 17:37:40.363302 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2021-10-18 17:37:40.363618 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2021-10-18 17:37:40.363927 (MainThread):   > called by model stg_customers (models/staging/stg_customers.sql)
2021-10-18 17:37:40.364246 (MainThread): 
2021-10-18 17:37:40.364598 (MainThread): Compilation Error in model stg_orders (models/staging/stg_orders.sql)
2021-10-18 17:37:40.364935 (MainThread):   Trying to create view `dbttutorial2021`.`dbt_jessie`.`stg_orders`, but it currently exists as a table. Either drop `dbttutorial2021`.`dbt_jessie`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-10-18 17:37:40.365258 (MainThread):   
2021-10-18 17:37:40.365564 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2021-10-18 17:37:40.365874 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2021-10-18 17:37:40.366180 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2021-10-18 17:37:40.366498 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2021-10-18 17:37:40.366812 (MainThread):   > called by model stg_orders (models/staging/stg_orders.sql)
2021-10-18 17:37:40.367069 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-10-18 17:37:40.367477 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc13bc09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1591f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc1591f828>]}
2021-10-18 17:37:40.367928 (MainThread): Flushing usage events
2021-10-18 17:37:55.179368 (MainThread): Running with dbt=0.21.0
2021-10-18 17:37:55.554412 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 17:37:55.555390 (MainThread): Tracking: tracking
2021-10-18 17:37:55.556908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72315ecda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72315ef748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7235af00f0>]}
2021-10-18 17:37:55.573895 (MainThread): Partial parsing not enabled
2021-10-18 17:37:55.584316 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:37:55.619598 (MainThread): Parsing macros/etc.sql
2021-10-18 17:37:55.622504 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:37:55.629751 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:37:55.643933 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:37:55.647857 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:37:55.650410 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:37:55.654586 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:37:55.675300 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:37:55.679287 (MainThread): Parsing macros/core.sql
2021-10-18 17:37:55.684599 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:37:55.697868 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:37:55.707356 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:37:55.741907 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:37:55.747846 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:37:55.757533 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:37:55.775354 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:37:55.777872 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:37:55.816778 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:37:55.839663 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:37:55.863923 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:37:55.866599 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:37:55.880247 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:37:55.890330 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:37:55.891912 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:37:55.895666 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:37:55.907653 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:37:55.910129 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:37:55.912974 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:37:55.915307 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:37:55.917636 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:37:55.981081 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:37:55.983335 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:37:55.985974 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:37:55.989752 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:37:56.240012 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:37:56.257294 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:37:56.261221 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:37:56.339905 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35091eb7-fb17-4e7e-b8f8-a19d1ee27893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7234e51b38>]}
2021-10-18 17:37:56.345599 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35091eb7-fb17-4e7e-b8f8-a19d1ee27893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72315e3160>]}
2021-10-18 17:37:56.346456 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:37:56.347955 (MainThread): 
2021-10-18 17:37:56.348605 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:37:56.350737 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 17:37:56.351399 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 17:37:56.832374 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 17:37:56.833105 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 17:37:56.845426 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:37:57.328363 (MainThread): 13:37:57 | Concurrency: 1 threads (target='dev')
2021-10-18 17:37:57.329007 (MainThread): 13:37:57 | 
2021-10-18 17:37:57.332758 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 17:37:57.333628 (Thread-1): 13:37:57 | 1 of 3 START view model dbt_jessie.stg_customers..................... [RUN]
2021-10-18 17:37:57.334578 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:37:57.335054 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 17:37:57.338624 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:37:57.339452 (Thread-1): finished collecting timing info
2021-10-18 17:37:57.390035 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:37:57.400536 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:37:57.988834 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:37:57.990054 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`stg_customers`
  OPTIONS()
  as select
    id          as customer_id,
    first_name  as first_name,
    last_name   as last_name

from `dbt-tutorial`.jaffle_shop.customers;


2021-10-18 17:37:59.078623 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 38962), raddr=('142.250.65.234', 443)>
2021-10-18 17:37:59.079439 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36044), raddr=('142.250.80.10', 443)>
2021-10-18 17:37:59.080332 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 38966), raddr=('142.250.65.234', 443)>
2021-10-18 17:37:59.081083 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36048), raddr=('142.250.80.10', 443)>
2021-10-18 17:37:59.084166 (Thread-1): finished collecting timing info
2021-10-18 17:37:59.085412 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35091eb7-fb17-4e7e-b8f8-a19d1ee27893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72303f4048>]}
2021-10-18 17:37:59.086485 (Thread-1): 13:37:59 | 1 of 3 OK created view model dbt_jessie.stg_customers................ [OK in 1.75s]
2021-10-18 17:37:59.087025 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 17:37:59.087802 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 17:37:59.088855 (Thread-1): 13:37:59 | 2 of 3 START view model dbt_jessie.stg_orders........................ [RUN]
2021-10-18 17:37:59.089897 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:37:59.090353 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 17:37:59.093365 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 17:37:59.094234 (Thread-1): finished collecting timing info
2021-10-18 17:37:59.098864 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:37:59.111114 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:37:59.596188 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 17:37:59.597223 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`stg_orders`
  OPTIONS()
  as select
    id         as order_id,
    user_id    as customer_id,
    order_date as order_date,
    status     as status

from `dbt-tutorial`.jaffle_shop.orders;


2021-10-18 17:38:00.725059 (Thread-1): finished collecting timing info
2021-10-18 17:38:00.726209 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35091eb7-fb17-4e7e-b8f8-a19d1ee27893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72315505c0>]}
2021-10-18 17:38:00.727204 (Thread-1): 13:38:00 | 2 of 3 OK created view model dbt_jessie.stg_orders................... [OK in 1.64s]
2021-10-18 17:38:00.727735 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 17:38:00.728865 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 17:38:00.729633 (Thread-1): 13:38:00 | 3 of 3 START table model dbt_jessie.customers........................ [RUN]
2021-10-18 17:38:00.730545 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:38:00.731006 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 17:38:00.737376 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 17:38:00.738207 (Thread-1): finished collecting timing info
2021-10-18 17:38:00.774432 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:38:00.785372 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:38:01.194956 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-10-18 17:38:01.195839 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `dbttutorial2021`.`dbt_jessie`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `dbttutorial2021`.`dbt_jessie`.`stg_customers`

),

orders as (

    select * from `dbttutorial2021`.`dbt_jessie`.`stg_orders`

),

customer_orders as (

    select
        customer_id     as customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-10-18 17:38:04.716058 (Thread-1): finished collecting timing info
2021-10-18 17:38:04.717336 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35091eb7-fb17-4e7e-b8f8-a19d1ee27893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72315505c0>]}
2021-10-18 17:38:04.718312 (Thread-1): 13:38:04 | 3 of 3 OK created table model dbt_jessie.customers................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.99s]
2021-10-18 17:38:04.718833 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 17:38:04.759925 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:38:04.761065 (MainThread): 13:38:04 | 
2021-10-18 17:38:04.761610 (MainThread): 13:38:04 | Finished running 2 view models, 1 table model in 8.41s.
2021-10-18 17:38:04.762065 (MainThread): Connection 'master' was properly closed.
2021-10-18 17:38:04.762490 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-10-18 17:38:04.772201 (MainThread): 
2021-10-18 17:38:04.772792 (MainThread): Completed successfully
2021-10-18 17:38:04.773333 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-10-18 17:38:04.773964 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72315027f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72315ef4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72315ff2e8>]}
2021-10-18 17:38:04.774596 (MainThread): Flushing usage events
2021-10-18 17:38:37.834569 (MainThread): Running with dbt=0.21.0
2021-10-18 17:38:38.416051 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['models/staging/stg_customers.sql', 'models/staging/stg_orders.sql'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-18 17:38:38.417380 (MainThread): Tracking: tracking
2021-10-18 17:38:38.419842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ba4bebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6bcd51b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6bcd51ef0>]}
2021-10-18 17:38:38.448267 (MainThread): Partial parsing not enabled
2021-10-18 17:38:38.463213 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:38:38.512753 (MainThread): Parsing macros/etc.sql
2021-10-18 17:38:38.516414 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:38:38.527665 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:38:38.548568 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:38:38.554833 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:38:38.558804 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:38:38.564254 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:38:38.594857 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:38:38.600088 (MainThread): Parsing macros/core.sql
2021-10-18 17:38:38.608603 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:38:38.626958 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:38:38.643509 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:38:38.696521 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:38:38.705917 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:38:38.723495 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:38:38.750094 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:38:38.755644 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:38:38.811910 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:38:38.844874 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:38:38.882651 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:38:38.886334 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:38:38.911268 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:38:38.925489 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:38:38.927965 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:38:38.934552 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:38:38.954540 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:38:38.958252 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:38:38.961955 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:38:38.965673 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:38:38.968918 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:38:39.068724 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:38:39.074198 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:38:39.076891 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:38:39.081127 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:38:39.500969 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:38:39.529061 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:38:39.535227 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:38:39.641571 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd2270d6-9e97-4504-81c3-f3dc56f27427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6be14be10>]}
2021-10-18 17:38:39.649320 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd2270d6-9e97-4504-81c3-f3dc56f27427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ba47b320>]}
2021-10-18 17:38:39.650021 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:38:39.652273 (MainThread): 
2021-10-18 17:38:39.653265 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:38:39.655896 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021".
2021-10-18 17:38:39.656761 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 17:38:40.251570 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 17:38:40.252288 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-18 17:38:40.265781 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:38:40.763159 (MainThread): 13:38:40 | Concurrency: 1 threads (target='dev')
2021-10-18 17:38:40.763817 (MainThread): 13:38:40 | 
2021-10-18 17:38:40.767775 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 17:38:40.768604 (Thread-1): 13:38:40 | 1 of 2 START view model dbt_jessie.stg_customers..................... [RUN]
2021-10-18 17:38:40.769537 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:38:40.769996 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 17:38:40.773580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:38:40.774664 (Thread-1): finished collecting timing info
2021-10-18 17:38:40.842607 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:38:40.843472 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:38:40.852275 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`stg_customers`
  OPTIONS()
  as select
    id          as customer_id,
    first_name  as first_name,
    last_name   as last_name

from `dbt-tutorial`.jaffle_shop.customers;


2021-10-18 17:38:41.901330 (Thread-1): finished collecting timing info
2021-10-18 17:38:41.902447 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd2270d6-9e97-4504-81c3-f3dc56f27427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ba3f4208>]}
2021-10-18 17:38:41.903376 (Thread-1): 13:38:41 | 1 of 2 OK created view model dbt_jessie.stg_customers................ [OK in 1.13s]
2021-10-18 17:38:41.903880 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 17:38:41.904446 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 17:38:41.905852 (Thread-1): 13:38:41 | 2 of 2 START view model dbt_jessie.stg_orders........................ [RUN]
2021-10-18 17:38:41.907908 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:38:41.908631 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 17:38:41.911469 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39002), raddr=('142.250.65.234', 443)>
2021-10-18 17:38:41.912115 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36084), raddr=('142.250.80.10', 443)>
2021-10-18 17:38:41.912666 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39006), raddr=('142.250.65.234', 443)>
2021-10-18 17:38:41.913198 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36088), raddr=('142.250.80.10', 443)>
2021-10-18 17:38:41.913924 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39010), raddr=('142.250.65.234', 443)>
2021-10-18 17:38:41.914378 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36092), raddr=('142.250.80.10', 443)>
2021-10-18 17:38:41.917449 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 17:38:41.918488 (Thread-1): finished collecting timing info
2021-10-18 17:38:41.927054 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 17:38:41.928634 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:38:41.943424 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbttutorial2021`.`dbt_jessie`.`stg_orders`
  OPTIONS()
  as select
    id         as order_id,
    user_id    as customer_id,
    order_date as order_date,
    status     as status

from `dbt-tutorial`.jaffle_shop.orders;


2021-10-18 17:38:42.914285 (Thread-1): finished collecting timing info
2021-10-18 17:38:42.915367 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd2270d6-9e97-4504-81c3-f3dc56f27427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6b8296f98>]}
2021-10-18 17:38:42.916411 (Thread-1): 13:38:42 | 2 of 2 OK created view model dbt_jessie.stg_orders................... [OK in 1.01s]
2021-10-18 17:38:42.917013 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 17:38:42.973853 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:38:42.975644 (MainThread): 13:38:42 | 
2021-10-18 17:38:42.976524 (MainThread): 13:38:42 | Finished running 2 view models in 3.32s.
2021-10-18 17:38:42.977224 (MainThread): Connection 'master' was properly closed.
2021-10-18 17:38:42.977648 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-10-18 17:38:42.987344 (MainThread): 
2021-10-18 17:38:42.987985 (MainThread): Completed successfully
2021-10-18 17:38:42.988495 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-10-18 17:38:42.989403 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ba4be4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6c01d92e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ba4b9630>]}
2021-10-18 17:38:42.990437 (MainThread): Flushing usage events
2021-10-18 17:43:45.314508 (MainThread): Running with dbt=0.21.0
2021-10-18 17:43:45.696133 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-10-18 17:43:45.707442 (MainThread): Tracking: tracking
2021-10-18 17:43:45.709102 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e66f502e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e66f50518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e66f504e0>]}
2021-10-18 17:43:45.725936 (MainThread): Partial parsing not enabled
2021-10-18 17:43:45.737560 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:43:45.770251 (MainThread): Parsing macros/etc.sql
2021-10-18 17:43:45.773231 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:43:45.781115 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:43:45.795150 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:43:45.799210 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:43:45.801844 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:43:45.805523 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:43:45.826107 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:43:45.830137 (MainThread): Parsing macros/core.sql
2021-10-18 17:43:45.835783 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:43:45.847993 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:43:45.856793 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:43:45.886767 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:43:45.892528 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:43:45.901857 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:43:45.920202 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:43:45.922776 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:43:45.966366 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:43:45.997068 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:43:46.024309 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:43:46.027180 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:43:46.040307 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:43:46.051233 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:43:46.053062 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:43:46.056676 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:43:46.068697 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:43:46.071141 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:43:46.073856 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:43:46.076818 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:43:46.079530 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:43:46.145943 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:43:46.148048 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:43:46.150225 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:43:46.153634 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:43:46.411043 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:43:46.428963 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:43:46.433409 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:43:46.519022 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.522416 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.525150 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.527988 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.530658 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.533756 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.546946 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.547441 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.550485 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.561355 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.561884 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:43:46.586751 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af9516cf-3730-4bf7-873a-d17ee5142e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e66ea0550>]}
2021-10-18 17:43:46.594867 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af9516cf-3730-4bf7-873a-d17ee5142e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e66f55908>]}
2021-10-18 17:43:46.595471 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:43:46.598192 (MainThread): 
2021-10-18 17:43:46.598858 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:43:46.601111 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 17:43:46.601680 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-18 17:43:46.608856 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:43:47.048119 (MainThread): 13:43:47 | Concurrency: 1 threads (target='dev')
2021-10-18 17:43:47.048853 (MainThread): 13:43:47 | 
2021-10-18 17:43:47.053010 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-10-18 17:43:47.053706 (Thread-1): 13:43:47 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-10-18 17:43:47.054634 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-10-18 17:43:47.055150 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-10-18 17:43:47.078404 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-10-18 17:43:47.079622 (Thread-1): finished collecting timing info
2021-10-18 17:43:47.122618 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-10-18 17:43:47.123366 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:43:47.130723 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `dbttutorial2021`.`dbt_jessie`.`stg_orders`
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2021-10-18 17:43:48.792237 (Thread-1): finished collecting timing info
2021-10-18 17:43:48.793529 (Thread-1): 13:43:48 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.74s]
2021-10-18 17:43:48.794110 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-10-18 17:43:48.794671 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-10-18 17:43:48.795190 (Thread-1): 13:43:48 | 2 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2021-10-18 17:43:48.796398 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-10-18 17:43:48.796944 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-10-18 17:43:48.814428 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-10-18 17:43:48.815422 (Thread-1): finished collecting timing info
2021-10-18 17:43:48.820067 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-10-18 17:43:48.821077 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:43:48.833505 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbttutorial2021`.`dbt_jessie`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
2021-10-18 17:43:50.531008 (Thread-1): finished collecting timing info
2021-10-18 17:43:50.532147 (Thread-1): 13:43:50 | 2 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 1.74s]
2021-10-18 17:43:50.532777 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-10-18 17:43:50.533412 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-10-18 17:43:50.533906 (Thread-1): 13:43:50 | 3 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2021-10-18 17:43:50.535326 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5".
2021-10-18 17:43:50.536062 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-10-18 17:43:50.538097 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39110), raddr=('142.250.65.234', 443)>
2021-10-18 17:43:50.538685 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36192), raddr=('142.250.80.10', 443)>
2021-10-18 17:43:50.545472 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
2021-10-18 17:43:50.546382 (Thread-1): finished collecting timing info
2021-10-18 17:43:50.550611 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
2021-10-18 17:43:50.551691 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:43:50.564326 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbttutorial2021`.`dbt_jessie`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
2021-10-18 17:43:52.233826 (Thread-1): finished collecting timing info
2021-10-18 17:43:52.235547 (Thread-1): 13:43:52 | 3 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 1.70s]
2021-10-18 17:43:52.236457 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-10-18 17:43:52.237603 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-10-18 17:43:52.238814 (Thread-1): 13:43:52 | 4 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2021-10-18 17:43:52.240159 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2021-10-18 17:43:52.240675 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-10-18 17:43:52.243376 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36184), raddr=('142.250.80.10', 443)>
2021-10-18 17:43:52.243941 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39102), raddr=('142.250.65.234', 443)>
2021-10-18 17:43:52.244487 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39106), raddr=('142.250.65.234', 443)>
2021-10-18 17:43:52.244949 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36188), raddr=('142.250.80.10', 443)>
2021-10-18 17:43:52.245544 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39116), raddr=('142.250.65.234', 443)>
2021-10-18 17:43:52.245975 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36198), raddr=('142.250.80.10', 443)>
2021-10-18 17:43:52.255513 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-10-18 17:43:52.256609 (Thread-1): finished collecting timing info
2021-10-18 17:43:52.261165 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-10-18 17:43:52.261944 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:43:52.273769 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbttutorial2021`.`dbt_jessie`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
2021-10-18 17:43:53.850225 (Thread-1): finished collecting timing info
2021-10-18 17:43:53.851381 (Thread-1): 13:43:53 | 4 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 1.61s]
2021-10-18 17:43:53.851971 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-10-18 17:43:53.852601 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-10-18 17:43:53.853501 (Thread-1): 13:43:53 | 5 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2021-10-18 17:43:53.854855 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-10-18 17:43:53.855431 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-10-18 17:43:53.867142 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-10-18 17:43:53.868178 (Thread-1): finished collecting timing info
2021-10-18 17:43:53.874013 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-10-18 17:43:53.875182 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:43:53.888021 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `dbttutorial2021`.`dbt_jessie`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `dbttutorial2021`.`dbt_jessie`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-10-18 17:43:56.003121 (Thread-1): finished collecting timing info
2021-10-18 17:43:56.004498 (Thread-1): 13:43:55 | 5 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 2.15s]
2021-10-18 17:43:56.005204 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-10-18 17:43:56.006056 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-10-18 17:43:56.006812 (Thread-1): 13:43:56 | 6 of 9 START test unique_stg_customers_customer_id................... [RUN]
2021-10-18 17:43:56.008234 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-10-18 17:43:56.008749 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-10-18 17:43:56.024820 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-10-18 17:43:56.026123 (Thread-1): finished collecting timing info
2021-10-18 17:43:56.031418 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-10-18 17:43:56.032390 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:43:56.044480 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `dbttutorial2021`.`dbt_jessie`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-18 17:43:58.007803 (Thread-1): finished collecting timing info
2021-10-18 17:43:58.008975 (Thread-1): 13:43:58 | 6 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 2.00s]
2021-10-18 17:43:58.009557 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-10-18 17:43:58.010152 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-10-18 17:43:58.010900 (Thread-1): 13:43:58 | 7 of 9 START test unique_stg_orders_order_id......................... [RUN]
2021-10-18 17:43:58.011735 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2021-10-18 17:43:58.012189 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-10-18 17:43:58.013624 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39128), raddr=('142.250.65.234', 443)>
2021-10-18 17:43:58.014190 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36210), raddr=('142.250.80.10', 443)>
2021-10-18 17:43:58.021234 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-10-18 17:43:58.022022 (Thread-1): finished collecting timing info
2021-10-18 17:43:58.027058 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-10-18 17:43:58.028183 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:43:58.041671 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `dbttutorial2021`.`dbt_jessie`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-18 17:43:59.747425 (Thread-1): finished collecting timing info
2021-10-18 17:43:59.748622 (Thread-1): 13:43:59 | 7 of 9 PASS unique_stg_orders_order_id............................... [PASS in 1.74s]
2021-10-18 17:43:59.749241 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-10-18 17:43:59.750624 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-10-18 17:43:59.751197 (Thread-1): 13:43:59 | 8 of 9 START test not_null_customers_customer_id..................... [RUN]
2021-10-18 17:43:59.752089 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2021-10-18 17:43:59.752535 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-10-18 17:43:59.760911 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-10-18 17:43:59.761760 (Thread-1): finished collecting timing info
2021-10-18 17:43:59.765985 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-10-18 17:43:59.767113 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:43:59.779418 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dbttutorial2021`.`dbt_jessie`.`customers`
where customer_id is null



      
    ) dbt_internal_test
2021-10-18 17:44:01.487854 (Thread-1): finished collecting timing info
2021-10-18 17:44:01.489136 (Thread-1): 13:44:01 | 8 of 9 PASS not_null_customers_customer_id........................... [PASS in 1.74s]
2021-10-18 17:44:01.489722 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-10-18 17:44:01.490385 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-10-18 17:44:01.490880 (Thread-1): 13:44:01 | 9 of 9 START test unique_customers_customer_id....................... [RUN]
2021-10-18 17:44:01.492131 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2021-10-18 17:44:01.492641 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-10-18 17:44:01.496950 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36202), raddr=('142.250.80.10', 443)>
2021-10-18 17:44:01.497809 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39120), raddr=('142.250.65.234', 443)>
2021-10-18 17:44:01.498487 (Thread-1): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39124), raddr=('142.250.65.234', 443)>
2021-10-18 17:44:01.498989 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36206), raddr=('142.250.80.10', 443)>
2021-10-18 17:44:01.499535 (Thread-1): unclosed <ssl.SSLSocket fd=11, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39132), raddr=('142.250.65.234', 443)>
2021-10-18 17:44:01.500002 (Thread-1): unclosed <ssl.SSLSocket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36214), raddr=('142.250.80.10', 443)>
2021-10-18 17:44:01.500530 (Thread-1): unclosed <ssl.SSLSocket fd=13, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39136), raddr=('142.250.65.234', 443)>
2021-10-18 17:44:01.501287 (Thread-1): unclosed <ssl.SSLSocket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36218), raddr=('142.250.80.10', 443)>
2021-10-18 17:44:01.510035 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-10-18 17:44:01.511224 (Thread-1): finished collecting timing info
2021-10-18 17:44:01.516188 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-10-18 17:44:01.517060 (Thread-1): Opening a new connection, currently in state closed
2021-10-18 17:44:01.529568 (Thread-1): On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `dbttutorial2021`.`dbt_jessie`.`customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-10-18 17:44:03.943762 (Thread-1): finished collecting timing info
2021-10-18 17:44:03.944856 (Thread-1): 13:44:03 | 9 of 9 PASS unique_customers_customer_id............................. [PASS in 2.45s]
2021-10-18 17:44:03.945527 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-10-18 17:44:04.005535 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:44:04.006341 (MainThread): 13:44:04 | 
2021-10-18 17:44:04.006759 (MainThread): 13:44:04 | Finished running 9 tests in 17.41s.
2021-10-18 17:44:04.007143 (MainThread): Connection 'master' was properly closed.
2021-10-18 17:44:04.007411 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
2021-10-18 17:44:04.008947 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39140), raddr=('142.250.65.234', 443)>
2021-10-18 17:44:04.009345 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36222), raddr=('142.250.80.10', 443)>
2021-10-18 17:44:04.015787 (MainThread): 
2021-10-18 17:44:04.016177 (MainThread): Completed successfully
2021-10-18 17:44:04.016562 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2021-10-18 17:44:04.016990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e64446e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e643e7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e643d2ba8>]}
2021-10-18 17:44:04.017478 (MainThread): Flushing usage events
2021-10-18 17:47:43.463391 (MainThread): Running with dbt=0.21.0
2021-10-18 17:47:43.849302 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-10-18 17:47:43.850536 (MainThread): Tracking: tracking
2021-10-18 17:47:43.852132 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc08e5e278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc08e5e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc08e5e4a8>]}
2021-10-18 17:47:43.869535 (MainThread): Partial parsing not enabled
2021-10-18 17:47:43.881567 (MainThread): Parsing macros/adapters.sql
2021-10-18 17:47:43.916141 (MainThread): Parsing macros/etc.sql
2021-10-18 17:47:43.919014 (MainThread): Parsing macros/catalog.sql
2021-10-18 17:47:43.926797 (MainThread): Parsing macros/materializations/table.sql
2021-10-18 17:47:43.944694 (MainThread): Parsing macros/materializations/seed.sql
2021-10-18 17:47:43.948213 (MainThread): Parsing macros/materializations/snapshot.sql
2021-10-18 17:47:43.950728 (MainThread): Parsing macros/materializations/copy.sql
2021-10-18 17:47:43.955031 (MainThread): Parsing macros/materializations/incremental.sql
2021-10-18 17:47:43.975620 (MainThread): Parsing macros/materializations/view.sql
2021-10-18 17:47:43.979484 (MainThread): Parsing macros/core.sql
2021-10-18 17:47:43.986059 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-18 17:47:44.000226 (MainThread): Parsing macros/materializations/test.sql
2021-10-18 17:47:44.009625 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-18 17:47:44.040291 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-18 17:47:44.045355 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-18 17:47:44.054987 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-18 17:47:44.073713 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-18 17:47:44.076207 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-18 17:47:44.116371 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-18 17:47:44.138502 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-10-18 17:47:44.163030 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-18 17:47:44.165868 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-18 17:47:44.180621 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-18 17:47:44.194227 (MainThread): Parsing macros/etc/query.sql
2021-10-18 17:47:44.195846 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-18 17:47:44.199695 (MainThread): Parsing macros/etc/datetime.sql
2021-10-18 17:47:44.211236 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-18 17:47:44.213899 (MainThread): Parsing macros/etc/where_subquery.sql
2021-10-18 17:47:44.216582 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-18 17:47:44.218837 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-18 17:47:44.221029 (MainThread): Parsing macros/adapters/common.sql
2021-10-18 17:47:44.288860 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-18 17:47:44.291240 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-18 17:47:44.292985 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-18 17:47:44.296262 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-18 17:47:44.560396 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:47:44.578916 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:47:44.583104 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:47:44.667997 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.671568 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.674933 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.677728 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.680780 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.685571 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.701724 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.702210 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.705208 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.716645 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.717294 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-10-18 17:47:44.739000 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e71387-d649-4948-b3e7-6b2a40f5058d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc08d96f98>]}
2021-10-18 17:47:44.747100 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e71387-d649-4948-b3e7-6b2a40f5058d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc08e5eba8>]}
2021-10-18 17:47:44.747681 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 184 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-18 17:47:44.750339 (MainThread): 
2021-10-18 17:47:44.750978 (MainThread): Acquiring new bigquery connection "master".
2021-10-18 17:47:44.752516 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial2021_dbt_jessie".
2021-10-18 17:47:44.752956 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-18 17:47:44.760244 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-10-18 17:47:45.339555 (MainThread): 13:47:45 | Concurrency: 1 threads (target='dev')
2021-10-18 17:47:45.340350 (MainThread): 13:47:45 | 
2021-10-18 17:47:45.344186 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-10-18 17:47:45.345498 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-10-18 17:47:45.346063 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-10-18 17:47:45.349918 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-10-18 17:47:45.350900 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.351801 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.353173 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-10-18 17:47:45.353818 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-10-18 17:47:45.354986 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-10-18 17:47:45.355735 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-10-18 17:47:45.360628 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-10-18 17:47:45.362221 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.362919 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.363962 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-10-18 17:47:45.364487 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-10-18 17:47:45.365714 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-10-18 17:47:45.366626 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-10-18 17:47:45.389656 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-10-18 17:47:45.390601 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.391188 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.392031 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-10-18 17:47:45.392497 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-10-18 17:47:45.393453 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada".
2021-10-18 17:47:45.393848 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-10-18 17:47:45.406665 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
2021-10-18 17:47:45.407489 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.408007 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.408869 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
2021-10-18 17:47:45.409393 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-10-18 17:47:45.410158 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-10-18 17:47:45.410841 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-10-18 17:47:45.421472 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-10-18 17:47:45.422141 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.422600 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.423302 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-10-18 17:47:45.423907 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-10-18 17:47:45.424685 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5".
2021-10-18 17:47:45.425065 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-10-18 17:47:45.430754 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
2021-10-18 17:47:45.431322 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.431727 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.432320 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
2021-10-18 17:47:45.432856 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-10-18 17:47:45.434063 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64".
2021-10-18 17:47:45.434563 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-10-18 17:47:45.442235 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
2021-10-18 17:47:45.442866 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.443373 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.444118 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
2021-10-18 17:47:45.444572 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-10-18 17:47:45.445437 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500".
2021-10-18 17:47:45.445815 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-10-18 17:47:45.452273 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
2021-10-18 17:47:45.452721 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.453060 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.453656 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
2021-10-18 17:47:45.454006 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-10-18 17:47:45.454601 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a".
2021-10-18 17:47:45.454870 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-10-18 17:47:45.457161 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('10.60.0.6', 36288), raddr=('142.250.80.10', 443)>
2021-10-18 17:47:45.457805 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('10.60.0.6', 39206), raddr=('142.250.65.234', 443)>
2021-10-18 17:47:45.462400 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
2021-10-18 17:47:45.462870 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.463246 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.463995 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
2021-10-18 17:47:45.465071 (Thread-1): Began running node model.jaffle_shop.customers
2021-10-18 17:47:45.465669 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-10-18 17:47:45.465956 (Thread-1): Compiling model.jaffle_shop.customers
2021-10-18 17:47:45.470415 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-10-18 17:47:45.470909 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.471298 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.471953 (Thread-1): Finished running node model.jaffle_shop.customers
2021-10-18 17:47:45.473059 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-10-18 17:47:45.473742 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d".
2021-10-18 17:47:45.474044 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-10-18 17:47:45.478811 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
2021-10-18 17:47:45.479350 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.479691 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.480283 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
2021-10-18 17:47:45.480620 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-10-18 17:47:45.481227 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1".
2021-10-18 17:47:45.481667 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-10-18 17:47:45.486721 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
2021-10-18 17:47:45.487217 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.487574 (Thread-1): finished collecting timing info
2021-10-18 17:47:45.488188 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
2021-10-18 17:47:45.544454 (MainThread): Connection 'master' was properly closed.
2021-10-18 17:47:45.545076 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
2021-10-18 17:47:45.555241 (MainThread): 13:47:45 | Done.
2021-10-18 17:47:45.560212 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-10-18 17:47:45.560703 (MainThread): 13:47:45 | Building catalog
2021-10-18 17:47:45.563365 (MainThread): Opening a new connection, currently in state init
2021-10-18 17:47:46.042217 (MainThread): Skipping catalog for dbttutorial2021.dbt_jessie_dbt_test__audit - schema does not exist
2021-10-18 17:47:46.043701 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbttutorial2021.information_schema".
2021-10-18 17:47:46.080586 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-10-18 17:47:46.092004 (ThreadPoolExecutor-1_0): On dbttutorial2021.information_schema: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbttutorial2021.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbttutorial2021`.`dbt_jessie`.__TABLES__
        where (upper(dataset_id) = upper('dbt_jessie'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbttutorial2021`.`dbt_jessie`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbttutorial2021`.`dbt_jessie`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-10-18 17:47:49.696383 (MainThread): 13:47:49 | Catalog written to /home/jessie/repos/dbt_projects/dbt_tutorial/target/catalog.json
2021-10-18 17:47:49.697097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc02335198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc02335278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc02335320>]}
2021-10-18 17:47:49.697757 (MainThread): Flushing usage events
2021-10-18 17:47:49.851975 (MainThread): Connection 'generate_catalog' was properly closed.
2021-10-18 17:47:49.852938 (MainThread): Connection 'dbttutorial2021.information_schema' was properly closed.
2021-10-18 17:47:55.432099 (MainThread): Running with dbt=0.21.0
2021-10-18 17:47:55.815633 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2021-10-18 17:47:55.816766 (MainThread): Tracking: tracking
2021-10-18 17:47:55.818401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe43a0c3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe43a0c3978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe43a07ec50>]}
2021-10-18 17:47:55.821927 (MainThread): Serving docs at 0.0.0.0:8080
2021-10-18 17:47:55.822438 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-10-18 17:47:55.822974 (MainThread): Press Ctrl+C to exit.


2021-10-18 17:47:55.828314 (MainThread): subprocess 24958 is still running
2021-10-18 17:52:42.960695 (MainThread): Flushing usage events
2021-10-18 17:52:43.115513 (MainThread): ctrl-c
2021-10-18 17:53:17.735746 (MainThread): Running with dbt=0.21.0
2021-10-18 17:53:18.321908 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.clean.CleanTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/jessie/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='clean', write_json=True)
2021-10-18 17:53:18.323099 (MainThread): Tracking: tracking
2021-10-18 17:53:18.324980 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c754001d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c75400048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c75400198>]}
2021-10-18 17:53:18.325759 (MainThread): Checking target/*
2021-10-18 17:53:18.329001 (MainThread):  Cleaned target/*
2021-10-18 17:53:18.329447 (MainThread): Checking dbt_modules/*
2021-10-18 17:53:18.330090 (MainThread):  Cleaned dbt_modules/*
2021-10-18 17:53:18.330439 (MainThread): Finished cleaning all paths.
2021-10-18 17:53:18.330917 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c754001d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c75400048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c75400470>]}
2021-10-18 17:53:18.331433 (MainThread): Flushing usage events
